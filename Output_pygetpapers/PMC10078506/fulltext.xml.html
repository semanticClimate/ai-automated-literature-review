<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Converted Document</title>
<style>
body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
.xml { margin: 0; padding: 0; }
.xml > * { margin: 10px 0; }
.xml > * > * { margin: 5px 0; }
.title { font-size: 1.5em; font-weight: bold; }
.section { margin: 20px 0; }
.section-title { font-size: 1.2em; font-weight: bold; margin: 10px 0; }
.paragraph { margin: 10px 0; }
.figure { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }
.figure-label { font-weight: bold; }
.figure-caption { font-style: italic; }
.table { margin: 20px 0; }
.table table { border-collapse: collapse; width: 100%; }
.table th, .table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
.table th { background-color: #f2f2f2; }
.list { margin: 10px 0; }
.list-item { margin: 5px 0; }
.reference { margin: 10px 0; padding: 5px; background-color: #f9f9f9; }
.bold { font-weight: bold; }
.italic { font-style: italic; }
.superscript { vertical-align: super; font-size: smaller; }
.subscript { vertical-align: sub; font-size: smaller; }
.link { color: #0066cc; text-decoration: none; }
.link:hover { text-decoration: underline; }
</style>
</head>
<body>
<div class="xml">
<div class="article"><span class="unknown">-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN</span><span class="unknown">public</span><span class="unknown">JATS-archive-oasis-article1-mathml3.dtd</span><span class="unknown">1.1</span><span class="unknown">jats-oasis2jats3.xsl</span><span class="unknown">1</span><span class="unknown">open_access</span><div class="processing-meta"><span class="restricted-by">pmc</span></div><div class="front"><div class="journal-meta"><span class="journal-id">J Adv Model Earth Syst</span><span class="journal-id">J Adv Model Earth Syst</span><span class="journal-id">10.1002/(ISSN)1942-2466</span><span class="journal-id">JAME</span><div class="journal-title-group"><span class="journal-title">Journal of Advances in Modeling Earth Systems</span></div><span class="issn">1942-2466</span><div class="publisher"><span class="publisher-name">John Wiley and Sons Inc.</span><span class="publisher-loc">Hoboken</span></div></div><div class="article-meta"><span class="article-id">10078506</span><span class="article-id">10.1029/2022MS002999</span><span class="article-id">JAME21718</span><span class="article-id">2022MS002999</span><div class="article-categories"><div class="subj-group"><span class="subject">Atmospheric Composition and Structure</span></div><div class="subj-group"><span class="subject">Air/Sea Constituent Fluxes</span></div><div class="subj-group"><span class="subject">Volcanic Effects</span></div><div class="subj-group"><span class="subject">Biogeosciences</span></div><div class="subj-group"><span class="subject">Climate Dynamics</span></div><div class="subj-group"><span class="subject">Modeling</span></div><div class="subj-group"><span class="subject">Computational Geophysics</span></div><div class="subj-group"><span class="subject">Modeling</span></div><div class="subj-group"><span class="subject">Numerical Solutions</span></div><div class="subj-group"><span class="subject">Cryosphere</span></div><div class="subj-group"><span class="subject">Avalanches</span></div><div class="subj-group"><span class="subject">Mass Balance</span></div><div class="subj-group"><span class="subject">Modeling</span></div><div class="subj-group"><span class="subject">Geodesy and Gravity</span></div><div class="subj-group"><span class="subject">Mass Balance</span></div><div class="subj-group"><span class="subject">Ocean Monitoring with Geodetic Techniques</span></div><div class="subj-group"><span class="subject">Ocean/Earth/atmosphere/hydrosphere/cryosphere interactions</span></div><div class="subj-group"><span class="subject">Global Change from Geodesy</span></div><div class="subj-group"><span class="subject">Global Change</span></div><div class="subj-group"><span class="subject">Climate Dynamics</span></div><div class="subj-group"><span class="subject">Global Change</span></div><div class="subj-group"><span class="subject">Abrupt/Rapid Climate Change</span></div><div class="subj-group"><span class="subject">Climate Variability</span></div><div class="subj-group"><span class="subject">Earth System Modeling</span></div><div class="subj-group"><span class="subject">Impacts of Global Change</span></div><div class="subj-group"><span class="subject">Land/Atmosphere Interactions</span></div><div class="subj-group"><span class="subject">Oceans</span></div><div class="subj-group"><span class="subject">Regional Climate Change</span></div><div class="subj-group"><span class="subject">Sea Level Change</span></div><div class="subj-group"><span class="subject">Solid Earth</span></div><div class="subj-group"><span class="subject">Water Cycles</span></div><div class="subj-group"><span class="subject">Hydrology</span></div><div class="subj-group"><span class="subject">Climate Impacts</span></div><div class="subj-group"><span class="subject">Hydrological Cycles and Budgets</span></div><div class="subj-group"><span class="subject">Land/Atmosphere Interactions</span></div><div class="subj-group"><span class="subject">Modeling</span></div><div class="subj-group"><span class="subject">Informatics</span></div><div class="subj-group"><span class="subject">Modeling</span></div><div class="subj-group"><span class="subject">Marine Geology and Geophysics</span></div><div class="subj-group"><span class="subject">Gravity and Isostasy</span></div><div class="subj-group"><span class="subject">Atmospheric Processes</span></div><div class="subj-group"><span class="subject">Climate Change and Variability</span></div><div class="subj-group"><span class="subject">Climatology</span></div><div class="subj-group"><span class="subject">General Circulation</span></div><div class="subj-group"><span class="subject">Land/Atmosphere Interactions</span></div><div class="subj-group"><span class="subject">Ocean/Atmosphere Interactions</span></div><div class="subj-group"><span class="subject">Regional Modeling</span></div><div class="subj-group"><span class="subject">Theoretical Modeling</span></div><div class="subj-group"><span class="subject">Oceanography: General</span></div><div class="subj-group"><span class="subject">Climate and Interannual Variability</span></div><div class="subj-group"><span class="subject">Numerical Modeling</span></div><div class="subj-group"><span class="subject">Natural Hazards</span></div><div class="subj-group"><span class="subject">Atmospheric</span></div><div class="subj-group"><span class="subject">Geological</span></div><div class="subj-group"><span class="subject">Oceanic</span></div><div class="subj-group"><span class="subject">Physical Modeling</span></div><div class="subj-group"><span class="subject">Climate Impact</span></div><div class="subj-group"><span class="subject">Risk</span></div><div class="subj-group"><span class="subject">Disaster Risk Analysis and Assessment</span></div><div class="subj-group"><span class="subject">Oceanography: Physical</span></div><div class="subj-group"><span class="subject">Air/Sea Interactions</span></div><div class="subj-group"><span class="subject">Decadal Ocean Variability</span></div><div class="subj-group"><span class="subject">General Circulation</span></div><div class="subj-group"><span class="subject">Ocean influence of Earth rotation</span></div><div class="subj-group"><span class="subject">Sea Level: Variations and Mean</span></div><div class="subj-group"><span class="subject">Surface Waves and Tides</span></div><div class="subj-group"><span class="subject">Tsunamis and Storm Surges</span></div><div class="subj-group"><span class="subject">Paleoceanography</span></div><div class="subj-group"><span class="subject">Abrupt/Rapid Climate Change</span></div><div class="subj-group"><span class="subject">Policy Sciences</span></div><div class="subj-group"><span class="subject">Benefit‐cost Analysis</span></div><div class="subj-group"><span class="subject">Radio Science</span></div><div class="subj-group"><span class="subject">Radio Oceanography</span></div><div class="subj-group"><span class="subject">Seismology</span></div><div class="subj-group"><span class="subject">Earthquake Ground Motions and Engineering Seismology</span></div><div class="subj-group"><span class="subject">Volcano Seismology</span></div><div class="subj-group"><span class="subject">Volcanology</span></div><div class="subj-group"><span class="subject">Volcano/Climate Interactions</span></div><div class="subj-group"><span class="subject">Atmospheric Effects</span></div><div class="subj-group"><span class="subject">Volcano Monitoring</span></div><div class="subj-group"><span class="subject">Effusive Volcanism</span></div><div class="subj-group"><span class="subject">Mud Volcanism</span></div><div class="subj-group"><span class="subject">Explosive Volcanism</span></div><div class="subj-group"><span class="subject">Volcanic Hazards and Risks</span></div><div class="subj-group"><span class="subject">Research Article</span></div><div class="subj-group"><span class="subject">Research Article</span></div></div><div class="title-group"><span class="article-title">Estimating Ocean Heat Uptake Using Boundary Green's Functions: A Perfect‐Model Test of the Method</span><span class="alt-title">Wu and Gregory</span></div><div class="contrib-group"><div class="contrib"><div class="name"><span class="surname">Wu</span><span class="given-names">Quran</span></div><span class="contrib-id">https://orcid.org/0000-0002-0686-8922</span><div class="xref"><span class="sup">1</span></div><div class="address"><span class="email">quran.wu@reading.ac.uk</span></div></div><div class="contrib"><div class="name"><span class="surname">Gregory</span><span class="given-names">Jonathan M.</span></div><span class="contrib-id">https://orcid.org/0000-0003-1296-8644</span><div class="xref"><span class="sup">1</span></div><div class="xref"><span class="sup">2</span></div></div></div><div class="aff"><div class="label"><span class="sup">1</span></div><span class="named-content">National Centre for Atmospheric Science</span><span class="institution">University of Reading</span><span class="city">Reading</span><span class="country">UK</span></div><div class="aff"><div class="label"><span class="sup">2</span></div><span class="institution">Met Office Hadley Centre</span><span class="city">Exeter</span><span class="country">UK</span></div><div class="author-notes"><div class="corresp"><span class="label">*</span><span class="bold">Correspondence to:</span><div class="break"></div>Q. Wu,<div class="break"></div><span class="email">quran.wu@reading.ac.uk</span><div class="break"></div></div></div><div class="pub-date"><span class="day">21</span><span class="month">12</span><span class="year">2022</span></div><div class="pub-date"><span class="month">12</span><span class="year">2022</span></div><span class="volume">14</span><span class="issue">12</span><span class="issue-id">10.1002/jame.v14.12</span><span class="elocation-id">e2022MS002999</span><div class="history"><div class="date"><span class="day">05</span><span class="month">10</span><span class="year">2022</span></div><div class="date"><span class="day">14</span><span class="month">1</span><span class="year">2022</span></div><div class="date"><span class="day">07</span><span class="month">10</span><span class="year">2022</span></div></div><div class="permissions"><span class="unknown">&#x000a9; 2022 The Authors. Journal of Advances in Modeling Earth Systems published by Wiley Periodicals LLC on behalf of American Geophysical Union.</span><span class="copyright-statement">© 2022 The Authors. Journal of Advances in Modeling Earth Systems published by Wiley Periodicals LLC on behalf of American Geophysical Union.</span><div class="license"><span class="license_ref">https://creativecommons.org/licenses/by/4.0/</span><div class="license-p">This is an open access article under the terms of the<span class="ext-link">http://creativecommons.org/licenses/by/4.0/</span>License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</div></div></div><div class="self-uri"></div><div class="abstract"><h2>Abstract</h2><p>Abstract Abstract Ocean heat uptake is caused by “excess heat” being added to the ocean surface by air‐sea fluxes and then carried to depths by ocean transports. One way to estimate excess heat in the ocean is to propagate observed sea surface temperature (SST) anomalies downward using a Green's function (GF) representation of ocean transports. Taking a “perfect‐model” approach, we test this GF method using a historical simulation, in which the true excess heat is diagnosed. We derive GFs from two approaches: (a) simulating GFs using idealized tracers, and (b) inferring GFs from simulated CFCs and climatological tracers. In the model world, we find that combining simulated GFs with SST anomalies reconstructs the Indo‐Pacific excess heat with a root‐mean‐square error of 26% for depth‐integrated changes; the corresponding number is 34% for inferred GFs. Simulated GFs are inaccurate because they are coarse grained in space and time to reduce computational cost. Inferred GFs are inaccurate because observations are insufficient constraints. Both kinds of GFs neglect the slowdown of the North Atlantic heat uptake as the ocean warms up. SST boundary conditions contain redistributive cooling in the Southern Ocean, which causes an underestimate of heat uptake there. All these errors are of comparable magnitude, and tend to compensate each other partially. Inferred excess heat is not sensitive to: (a) small changes in the shape of prior GFs, or (b) additional constraints from SF Ocean heat uptake is caused by “excess heat” being added to the ocean surface by air‐sea fluxes and then carried to depths by ocean transports. One way to estimate excess heat in the ocean is to propagate observed sea surface temperature (SST) anomalies downward using a Green's function (GF) representation of ocean transports. Taking a “perfect‐model” approach, we test this GF method using a historical simulation, in which the true excess heat is diagnosed. We derive GFs from two approaches: (a) simulating GFs using idealized tracers, and (b) inferring GFs from simulated CFCs and climatological tracers. In the model world, we find that combining simulated GFs with SST anomalies reconstructs the Indo‐Pacific excess heat with a root‐mean‐square error of 26% for depth‐integrated changes; the corresponding number is 34% for inferred GFs. Simulated GFs are inaccurate because they are coarse grained in space and time to reduce computational cost. Inferred GFs are inaccurate because observations are insufficient constraints. Both kinds of GFs neglect the slowdown of the North Atlantic heat uptake as the ocean warms up. SST boundary conditions contain redistributive cooling in the Southern Ocean, which causes an underestimate of heat uptake there. All these errors are of comparable magnitude, and tend to compensate each other partially. Inferred excess heat is not sensitive to: (a) small changes in the shape of prior GFs, or (b) additional constraints from SF <span class="subscript">6</span> and bomb <span class="superscript">14</span> C.</p></div><div class="abstract"><h2>Abstract</h2><p>Key Points Key Points  Green's functions (GFs) broadly reconstruct simulated ocean heat uptake when constrained by simulated observations in a historical simulation Green's functions (GFs) broadly reconstruct simulated ocean heat uptake when constrained by simulated observations in a historical simulation Errors in the GF method arise from insufficient observational constraints and forced changes in ocean transports Errors in the GF method arise from insufficient observational constraints and forced changes in ocean transports GFs underestimate the Southern Ocean heat uptake when using sea surface temperature anomalies as boundary conditions GFs underestimate the Southern Ocean heat uptake when using sea surface temperature anomalies as boundary conditions</p></div><div class="kwd-group"><span class="kwd">ocean heat uptake</span><span class="kwd">passive tracer</span><span class="kwd">Green's function</span><span class="kwd">maximum entropy</span></div><div class="funding-group"><div class="award-group"><div class="funding-source"><div class="institution-wrap"><span class="institution">Natural Environment Research Council</span><span class="institution-id">10.13039/501100000270</span></div></div><span class="award-id">NE/P019099/1</span></div><div class="award-group"><div class="funding-source"><div class="institution-wrap"><span class="institution">Horizon Europe European Research Council</span><span class="institution-id">10.13039/100019180</span></div></div><span class="award-id">786427</span></div></div><div class="counts"><div class="fig-count"></div><div class="table-count"></div><div class="page-count"></div><div class="word-count"></div></div><div class="custom-meta-group"><div class="custom-meta"><span class="meta-name">source-schema-version-number</span><span class="meta-value">2.0</span></div><div class="custom-meta"><span class="meta-name">cover-date</span><span class="meta-value">December 2022</span></div><div class="custom-meta"><span class="meta-name">details-of-publishers-convertor</span><span class="meta-value">Converter:WILEY_ML3GV2_TO_JATSPMC version:6.2.7 mode:remove_FC converted:06.04.2023</span></div></div></div><div class="notes"><p class="p">Wu Wu , Q. Q. , &  Gregory Gregory , J. M. J. M. ( 2022 2022 ). Estimating ocean heat uptake using boundary Green's functions: A perfect‐model test of the method Estimating ocean heat uptake using boundary Green's functions: A perfect‐model test of the method . Journal of Advances in Modeling Earth Systems Journal of Advances in Modeling Earth Systems , 14 14 , e2022MS002999 e2022MS002999 . 10.1029/2022MS002999 10.1029/2022MS002999</p></div></div><div class="body"><div class="section"><h2 class="section-title">Introduction</h2><span class="label">1</span><p class="p">Imbalance in Earth's top‐of‐atmosphere radiative forcing leads to accumulation of “excess heat” in the climate system. Over 93% of the excess heat is stored in the ocean, causing ocean warming and sea‐level rise (Meyssignac et al., 2019 2019 ). Excess heat invades the ocean from the surface, like a drop of dye spreads in a water tank. This process can be conveniently described using a mathematical tool called Green's functions (GFs). Here, we examine how accurately excess heat in the ocean can be estimated using GFs.</p><p class="p">A change in ocean heat content can be understood in terms of excess and redistributed heat content. Excess heat is defined as the change (warming or cooling) that is added to the ocean by air‐sea fluxes, and then carried to depths by ocean transports. Redistributed heat, on the other hand, is defined as the change of the pre‐existing heat in the ocean (i.e., spatial redistribution). Isolating excess heat is useful because: (a) excess heat change can be constrained by observations of transient tracers in the ocean (see Section 6 6 ), and (b) excess heat change dominates global/basin integrated ocean heat content change. Under CO <span class="subscript">2</span> forcing, climate models show that excess heat largely accumulates in the North Atlantic and the Southern Ocean, while redistributed heat tends to accumulate at low latitudes (Gregory et al., 2016 2016 ; Newsom et al., 2022 2022 ). Excess and redistributed heat are both theoretical constructs; neither of them is directly observable in the ocean.</p><p class="p">Excess heat at depths can be estimated by propagating its surface “source” downward using boundary GFs of the tracer equation (Holzer & Hall, 2000 2000 ). We refer to this method as the GF method. The source or boundary condition (BC) of excess heat is often computed from observed sea surface temperature (SST) in the literature (e.g., Messias & Mercier, 2022 2022 ; Zanna et al., 2019 2019 ). Boundary GFs represent the ocean's surface‐to‐interior transport. They can be derived from: (a) simulating idealized tracers in a model (e.g., Khatiwala et al., 2005 2005 ; Zanna et al., 2019 2019 ) or (b) solving an inverse problem using tracer observations (e.g., Holzer et al., 2010 2010 ; Khatiwala et al., 2009 2009 ). The GF method adds useful information to the in‐situ estimate of ocean heat content change. The two estimates are directly comparable for basin integrals; regionally, their differences indicate redistributed heat in the ocean.</p><span class="p">We refer to GFs derived from model simulations as “simulated GFs,” and GFs inferred from tracer observations as “inferred GFs.” In practice, both types of GFs are at best approximations of the real‐world ocean transport, due to various assumptions, simplifications and trade‐offs. Simulated GFs are often coarse grained in space and time, hence they do not fully capture the covariance between the true GFs and surface BCs. In addition, simulated GFs rely on a model's ocean transports, but no model is perfect. Inferred GFs, on the other hand, do not rely on a model; but they too are inaccurate, because observations are insufficient constraints.</span><p class="p">As well as the GFs, surface BCs are not perfectly known for estimating excess heat. SST anomalies, as used by Zanna et al. ( 2019 2019 ), are contaminated by redistributed temperatures which are not BCs of excess heat. This error affects both types of GFs.</p><span class="p">The accuracy of the GF method for estimating excess heat in the ocean has not been examined in the literature. In this study, we address this problem using a HadCM3 historical simulation (1860–2008). We treat this simulation as the real world, and compare excess heat diagnosed in it (as the “truth”) with that estimated using simulated/inferred GFs. This approach is useful because it allows a separation of excess and redistributed heat and a quantification of different errors, both of which are not accessible in observations.</span><span class="p">Because our historical simulation agrees well with observations for large‐scale ocean heat uptake, our error estimates are relevant to applying the GF method to the real world. Importantly, our result pinpoints the main error sources in the GF method, and provides a quantitative benchmark for each of them. Nonetheless, we expect that at least some of our error estimates are HadCM3 specific, especially since HadCM3 is a coarse resolution model and not constrained by observations. Future studies with high‐resolution models or ocean state estimates would be useful to provide a more robust error estimate.</span><p class="p">Setup of the HadCM3 historical simulation and definitions of excess and redistributed heat are explained in Section 2 2 . In Section 3 3 , we explain how to solve the passive tracer equation using GFs. Section 4 4 explains the method of simulating GFs. Section 5 5 evaluates excess heat estimates based on simulated GFs. The same pattern is repeated in Sections 6 6 and 7 7 , but for inferred GFs. Finally, a summary is given in Section 8 8 and discussions in Section 9 9 .</p></div><div class="section"><h2 class="section-title">Historical Simulation and Temperature Tracers</h2><span class="label">2</span><div class="section"><h2 class="section-title">Setup of Historical Simulation</h2><span class="label">2.1</span><p class="p">HadCM3 is an Atmosphere‐Ocean General Circulation Model (AOGCM) that has been used extensively for climate studies (Gordon et al., 2000 2000 ). The HadCM3 atmosphere model is based on the UK Met Office Unified Model, with a horizontal resolution of 2.5° × 3.75° and 19 vertical layers. The HadCM3 ocean model is based on the Cox ( 1984 1984 ) model with a horizontal resolution of 1.25° × 1.25° and 20 vertical levels (vertical resolution is enhanced near the surface). Horizontal eddy mixing of tracers in the HadCM3 ocean is parameterized using the Gent and Mcwilliams ( 1990 1990 ) and Redi ( 1982 1982 ) schemes.</p><p class="p">We run a pre‐industrial control experiment and a historical experiment in parallel with HadCM3. Both experiments start from a pre‐industrial state at 1860 and run to 2008. (This choice omits the ocean's slow response to the global cooling before 1860 cf., Gebbie and Huybers ( 2019 2019 ).) The historical experiment is conducted by adding historical effective radiative forcing <span class="italic">Q</span>  <span class="subscript">ERF</span> (space and time dependent) to the sea‐water surface. To compute <span class="italic">Q</span>  <span class="subscript">ERF</span> the atmosphere model ECHAM6.3 (Giorgetta et al., 2013 2013 ) is forced with time‐dependent historical changes in all forcing agents and fixed pre‐industrial SSTs and sea ice concentrations, following the design of the piClim‐histall experiment (Pincus et al., 2016 2016 ). This ECHAM6.3 simulation is used in Gregory et al. ( 2020 2020 ) to compute the global‐mean <span class="italic">Q</span>  <span class="subscript">ERF</span> . Note that we choose to force HadCM3 with <span class="italic">Q</span>  <span class="subscript">ERF</span> instead of adding forcing agents to its atmosphere; Appendix A A explains the motivation for this choice.</p></div><div class="section"><h2 class="section-title">Evolution Equations of Temperature Tracers</h2><span class="label">2.2</span><div class="section"><h2 class="section-title">Historical and Control Temperatures</h2><span class="label">2.2.1</span><p class="p">Evolution of ocean potential temperature Θ in the control and historical experiments can, in general, be written as  (1) (1)  ∂ ∂ Θ Θ ∂ ∂ t t + + Φ Φ ( ( Θ Θ ) ) = = Ψ Ψ , , initial condition: initial condition: Θ Θ ( ( 0 0 ) ) = = Θ Θ 0 0 . . Θ <span class="subscript">0</span> is the pre‐industrial state at 1860. Ψ is the source/sink of Θ; it is zero everywhere except at the surface (ignoring geothermal heat flux). Φ is the ocean transport operator that evolves an ocean tracer field forward in time. A simple form of Φ can be given as  (2) (2)  Φ Φ ( ( χ χ ) ) = = v v ⋅ ⋅ ∇ ∇ χ χ − − ∇ ∇ ⋅ ⋅ κ κ δ δ ∇ ∇ δ δ χ χ − − ∂ ∂ ∂ ∂ z z κ κ z z ∂ ∂ χ χ ∂ ∂ z z . .  <span class="italic">χ</span> is the concentration of a tracer. <span class="bold">v</span> is a 3D velocity vector. <span class="italic">κ</span>  <span class="subscript"><span class="italic">δ</span></span> and <span class="italic">κ</span>  <span class="subscript"><span class="italic">z</span></span> are isopycnal and vertical eddy diffusivities, respectively. ∇ <span class="subscript"><span class="italic">δ</span></span> computes the lateral gradient of a scalar on isopycnal surfaces. Note that the Φ operator in modern ocean models is more complex than Equation 2 2 .</p><p class="p">The control and historical Θ fields are different because the two experiments have different Φ and Ψ. The ocean transport operator Φ is different because global warming affects ocean transports in many ways; for example, a reduction in high‐latitude convection. The surface source Ψ = <span class="italic">Q</span>  <span class="subscript">ctrl</span> /( <span class="italic">ρ</span>  <span class="subscript">0</span>  <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> d <span class="italic">z</span>  <span class="subscript">1</span> ) in the control experiment, where <span class="italic">Q</span>  <span class="subscript">ctrl</span> is the net surface heat flux (W m <span class="superscript">−2</span> ) under the pre‐industrial condition. In the historical experiment Ψ = ( <span class="italic">Q</span>  <span class="subscript">ctrl</span> + <span class="italic">Q</span>  <span class="subscript">ERF</span> + <span class="italic">Q</span> ′)/( <span class="italic">ρ</span>  <span class="subscript">0</span>  <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> d <span class="italic">z</span>  <span class="subscript">1</span> ); the two additional terms come from: (a) the historical forcing ( <span class="italic">Q</span>  <span class="subscript">ERF</span> ) and (b) climate feedbacks ( <span class="italic">Q</span> ′) in response to the forcing. <span class="italic">ρ</span>  <span class="subscript">0</span>  <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> d <span class="italic">z</span>  <span class="subscript">1</span> is the top layer thermal inertia (J K <span class="superscript">−1</span> m <span class="superscript">−2</span> ), wherein <span class="italic">ρ</span>  <span class="subscript">0</span> is reference density, <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> specific heat capacity, and d <span class="italic">z</span>  <span class="subscript">1</span> top layer thickness.</p></div><div class="section"><h2 class="section-title">Linear Equations of Temperature Evolution</h2><span class="label">2.2.2</span><p class="p">Φ is a non‐linear operator when applied to Θ, because Φ itself depends on Θ; for instance, <span class="bold">v</span> in Equation 2 2 is a function of Θ. To facilitate a linear decomposition of temperature change, we define two linear versions of Φ, denoted as <span class="italic">L</span>  <span class="subscript">ctrl</span> and <span class="italic">L</span>  <span class="subscript">hist</span> , using velocities and diffusivities from the control and historical experiments, respectively. Unlike the Φ operator, which is a function of ocean states, the <span class="italic">L</span> operator is a pre‐computed quantity, for example, an array of coefficients. The evolution equation of Θ in the control experiment can be rewritten as  (3) (3)  ∂ ∂ Θ Θ ctrl ctrl ∂ ∂ t t + + L L ctrl ctrl Θ Θ ctrl ctrl = = 1 1 ρ ρ 0 0 c c p p d d z z 1 1 Q Q ctrl ctrl , , initial condition: initial condition: Θ Θ ctrl ctrl ( ( 0 0 ) ) = = Θ Θ 0 0 . . Similarly, the evolution equation of Θ in the historical experiment can be rewritten as  (4) (4)  ∂ ∂ Θ Θ hist hist ∂ ∂ t t + + L L hist hist Θ Θ hist hist = = 1 1 ρ ρ 0 0 c c p p d d z z 1 1 Q Q ctrl ctrl + + Q Q ERF ERF + + Q Q ′ ′ , , initial condition: initial condition: Θ Θ hist hist ( ( 0 0 ) ) = = Θ Θ 0 0 . .</p><p class="p">It is important to note that <span class="italic">L</span>  <span class="subscript">ctrl</span> and <span class="italic">L</span>  <span class="subscript">hist</span> are linear operators when applied to any tracer fields. For instance, we have <span class="italic">L</span>  <span class="subscript">hist</span> (Θ <span class="subscript">hist</span> ) − <span class="italic">L</span>  <span class="subscript">hist</span> (Θ <span class="subscript">ctrl</span> ) = <span class="italic">L</span>  <span class="subscript">hist</span> (Θ <span class="subscript">hist</span> − Θ <span class="subscript">ctrl</span> ). The same does not hold for the Φ operator because it is nonlinear in Θ. In Section 2.2.3 2.2.3 , we will use the linearity of <span class="italic">L</span>  <span class="subscript">hist</span> to derive the governing equation of redistributed temperature. <span class="italic">L</span>  <span class="subscript">ctrl</span> and <span class="italic">L</span>  <span class="subscript">hist</span> both have time‐varying coefficients due to variability and change in ocean transports.</p></div><div class="section"><h2 class="section-title">Excess and Redistributed Temperatures</h2><span class="label">2.2.3</span><p class="p">Temperature anomaly in the historical simulation relative to the control can be written as the sum of two passive tracers, Θ <span class="subscript">e</span> and Θ <span class="subscript">r</span>   (5) (5)  Θ Θ a a = = Θ Θ hist hist − − Θ Θ ctrl ctrl = = Θ Θ e e + + Θ Θ r r . . The excess temperature Θ <span class="subscript">e</span> is the part of Θ <span class="subscript">a</span> driven by changes in surface heat fluxes (Equations 3 3 and 4 4 have different right‐hand‐side forcing terms). Its evolution equation is defined as  (6) (6)  ∂ ∂ Θ Θ e e ∂ ∂ t t + + L L hist hist Θ Θ e e = = 1 1 ρ ρ 0 0 c c p p d d z z 1 1 Q Q ERF ERF + + Q Q ′ ′ , , initial condition: initial condition: Θ Θ e e ( ( 0 0 ) ) = = 0 0 . . We implement Equation 6 6 by simulating Θ <span class="subscript">e</span> as a passive tracer in the historical simulation from 1860 to 2008. The redistributed temperature Θ <span class="subscript">r</span> is the part of Θ <span class="subscript">a</span> driven by changes in ocean transports (Equations 3 3 and 4 4 have different transport operators). Its evolution equation can be derived by combining Equations (3) (3) , (4) (4) , (5) (5) , (6) (6) and making use of the linearity of <span class="italic">L</span>  <span class="subscript">hist</span> .  (7) (7)  ∂ ∂ Θ Θ r r ∂ ∂ t t + + L L hist hist Θ Θ r r = = L L ctrl ctrl Θ Θ ctrl ctrl − − L L hist hist Θ Θ ctrl ctrl , , initial condition: initial condition: Θ Θ r r ( ( 0 0 ) ) = = 0 0 . . Note that changes in ocean transports acting on Θ <span class="subscript">ctrl</span> are the source term of Θ <span class="subscript">r</span> . For convenience, we compute Θ <span class="subscript">r</span> as Θ <span class="subscript">a</span> − Θ <span class="subscript">e</span> (Equation 5 5 ) instead of using Equation 7 7 . In the historical simulation, Θ <span class="subscript">e</span> and Θ <span class="subscript">r</span> are both affected by unforced variability and forced climate change. We focus on multi‐decadal changes in Θ <span class="subscript">e</span> and Θ <span class="subscript">r</span> to highlight the role of forced response.</p><p class="p">The key difference between Θ <span class="subscript">e</span> and Θ <span class="subscript">r</span> is that Θ <span class="subscript">e</span> only comes from the surface, while Θ <span class="subscript">r</span> has sources throughout the volume of the ocean. The global volume integral of Θ <span class="subscript">r</span> is zero, because the effect of <span class="italic">L</span> integrates to zero over the global ocean. (Θ <span class="subscript">r</span> defined in Gregory et al. ( 2016 2016 ) does not have exactly zero volume integral.)</p></div><div class="section"><h2 class="section-title">Converting Temperature to Heat Content</h2><span class="label">2.2.4</span><p class="p">We compute ocean heat content anomaly H H a a as ∫ ∫ V V ρ ρ 0 0 c c p p Θ Θ hist hist − − Θ Θ ctrl ctrl d d 3 3 r r . <span class="bold">r</span> is a 3D position vector of the ocean, V V an arbitrary control volume, and <span class="italic">ρ</span>  <span class="subscript">0</span>  <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> ≡ 4 × 10 <span class="superscript">6</span> J K <span class="superscript">−1</span> m <span class="superscript">−3</span> . Applying the same procedure to Θ <span class="subscript">e</span> and Θ <span class="subscript">r</span> results in excess heat content H H e e and redistributed heat content H H r r , respectively H H a a = = H H e e + + H H r r .</p></div></div><div class="section"><h2 class="section-title">Evaluation of Historical Simulation</h2><span class="label">2.3</span><p class="p">The HadCM3 historical simulation captures the surface and depth integrated ocean warming in observations reasonably well (Figure 1 1 ). The global mean SST in HadCM3 generally follows that in HadISST (Rayner et al., 2003 2003 ), but it does not capture the early 21st century warming hiatus in HadISST (Figure 1a 1a ). HadCM3 also tends to overestimate the surface cooling after volcanic eruptions compared to observations (Figure 1a 1a ); this is a common feature among CMIP5 models (D. M. Smith et al., 2016 2016 ; Marotzke & Forster, 2015 2015 ). In both HadCM3 and observations of Cheng et al. ( 2017 2017 ), the global integrated H H a a (0–2,000 m) increases by about 300 ZJ in 2008 relative to 1946–1955 (1 ZJ = 1 × 10 <span class="superscript">21</span> J); more than half of that is stored in the Indo‐Pacific (Figures 1b–1d 1b–1d ). HadCM3 does not capture the observed plateauing of H H a a increase after the 1963 Mount Agung eruption (Figures 1b 1b and 1c 1c ).</p><div class="figure"><div class="figure-label">Figure 1</div><div class="figure-caption">Surface and depth integrated ocean warming in the HadCM3 historical simulation. (a) Global averaged sea surface temperature. (b) Global integrated ocean heat content. Panels (c and d) are the same as panel (b), but for basin integrals. Global and basin integrals are calculated for the 0–2,000 m layers. All quantities are shown as anomalies relative to the 1946–1955 average. For comparison, observational estimates from Rayner et al. ( Surface and depth integrated ocean warming in the HadCM3 historical simulation. (a) Global averaged sea surface temperature. (b) Global integrated ocean heat content. Panels (c and d) are the same as panel (b), but for basin integrals. Global and basin integrals are calculated for the 0–2,000 m layers. All quantities are shown as anomalies relative to the 1946–1955 average. For comparison, observational estimates from Rayner et al. ( 2003 2003 ) (HadISST) and Cheng et al. ( 2017 2017 ) (heat content) are also plotted. 1 ZJ = 1 × 10 <span class="superscript">21</span> J.</div><div class="graphic"></div></div><p class="p">We compare H H e e and H H r r simulated in HadCM3 with those in Bronselaer and Zanna ( 2020 2020 ) (BZ2020). BZ2020 infers H H e e by scaling the pattern of anthropogenic carbon in the ocean; H H r r is then derived by subtracting inferred H H e e from observed H H a a change.</p><p class="p">HadCM3 and BZ2020 have similar patterns of H H e e changes during 1951–2008 (Figure 2 2 left column, changes are integrated over 0–2,000 m). In both of them, H H e e tends to accumulate in the subtropical gyres and the North Atlantic, but features little signal at low latitudes. HadCM3 has larger H H e e changes than BZ2020 in the North Atlantic and the Arctic. This is partly due to different definitions of H H e e . The H H e e of BZ2020 is defined in a fixed‐circulation scenario, which has a smaller <span class="italic">Q</span>  <span class="subscript">ERF</span> + <span class="italic">Q</span> ′, hence a smaller H H e e , than a free‐circulation scenario (i.e., the HadCM3 simulation) at northern high latitudes (Winton et al., 2013 2013 ). H H r r is less coherent in space than H H e e in both HadCM3 and BZ2020; the two data sets show very different H H r r changes in the subpolar North Atlantic and the Southern Ocean (Figure 2 2 , right column).</p><div class="figure"><div class="figure-label">Figure 2</div><div class="figure-caption">Linear trends of excess and redistributed heat content (0–2,000 m integrated) during the 1951–2008 period. (a and b) Bronselaer and Zanna ( Linear trends of excess and redistributed heat content (0–2,000 m integrated) during the 1951–2008 period. (a and b) Bronselaer and Zanna ( 2020 2020 ) (based on anthropogenic carbon). (c and d) HadCM3 historical simulation. 1 GJ = 1 × 10 <span class="superscript">9</span> J.</div><div class="graphic"></div></div></div><div class="section"><h2 class="section-title">Heat Uptake by Control Ocean Transport</h2><span class="label">2.4</span><p class="p">How important is the control ocean transport <span class="italic">L</span>  <span class="subscript">ctrl</span> in shaping the regional pattern of H H e e ? We investigate this question using the pseudo excess temperature Θ Θ e e ∗ ∗   (8) (8)  ∂ ∂ Θ Θ e e ∗ ∗ ∂ ∂ t t + + L L ctrl ctrl Θ Θ e e ∗ ∗ = = 1 1 ρ ρ 0 0 c c p p d d z z 1 1 Q Q ERF ERF + + Q Q ′ ′ , , initial condition: initial condition: Θ Θ e e ∗ ∗ ( ( 0 0 ) ) = = 0 0 . .  Θ Θ e e ∗ ∗ is evolved by the control transport <span class="italic">L</span>  <span class="subscript">ctrl</span> , as if heat uptake does not affect ocean transports. This is in contrast with Θ <span class="subscript">e</span> which is evolved by the historical transport <span class="italic">L</span>  <span class="subscript">hist</span> . We implement Equation 8 8 by simulating Θ Θ e e ∗ ∗ as a passive tracer in the control experiment from 1860 to 2008. Pseudo excess heat content is denoted as H H e e ∗ ∗ = = ∫ ∫ V V ρ ρ 0 0 c c p p Θ Θ e e ∗ ∗ d d 3 3 r r .</p><p class="p">Changes of H H a a , H H e e and H H e e ∗ ∗ in 1999–2008 relative 1946–1955 are shown in Figure 3 3 (a change is denoted as “Δ”). Δ Δ H H a a is much less uniform than Δ Δ H H e e and Δ Δ H H e e ∗ ∗ across latitudes (Figures 3a 3a and 3b 3b ), highlighting the role of Δ Δ H H r r in shaping the patterns of Δ Δ H H a a . A similar result is found in Zika et al. ( 2021 2021 ) but on a shorter timescale (2006–2017).</p><div class="figure"><div class="figure-label">Figure 3</div><div class="figure-caption">Excess heat content change resulting from (1) historical and (2) control ocean transports. These two quantities are denoted as Excess heat content change resulting from (1) historical and (2) control ocean transports. These two quantities are denoted as Δ Δ H H e e (red line) and Δ Δ H H e e ∗ ∗ (blue line), respectively. Total heat content change ( Δ Δ H H a a = Δ Δ H H e e + Δ Δ H H r r ) is shown as black lines. (a and b) Zonal‐and‐depth integrated change (0–2,000 m). (c and f) Depth distribution of panels (a and b). A change is calculated as the difference between 1999–2008 and 1946–1955. In panels (e and f), contours indicate Δ Δ H H e e and Δ Δ H H e e ∗ ∗ ; shading indicates Δ Δ H H e e minus Δ Δ H H e e ∗ ∗ . Contour levels are 10, 30, and 45 in panel (c); 5, 15, and 25 in panel (d); 10, 20, 30, 50, and 70 in panel (e); and 5, 10, 15, and 25 in panel (f). 1 PJ = 1 × 10 <span class="superscript">15</span> J. 1 TJ = 1 × 10 <span class="superscript">12</span> J.</div><div class="graphic"></div></div><p class="p">The latitude distributions of Δ Δ H H e e and Δ Δ H H e e ∗ ∗ are very similar, especially in the southern subtropics (Figure 3 3 , compare red and blue lines). This suggests that the patterns of Δ Δ H H e e is mostly driven by the climatological ocean transport (i.e., <span class="italic">L</span>  <span class="subscript">ctrl</span> ), not its transient response (i.e., differences between <span class="italic">L</span>  <span class="subscript">hist</span> and <span class="italic">L</span>  <span class="subscript">ctrl</span> ). A similar conclusion was found in several climate models under 1% increase of the atmospheric CO <span class="subscript">2</span> concentration (Couldrey et al., 2021 2021 ; Gregory et al., 2016 2016 ). Differences between Δ Δ H H e e and Δ Δ H H e e ∗ ∗ are most evident at northern mid latitudes, where Δ Δ H H e e is redistributed equatorward relative to Δ Δ H H e e ∗ ∗ in 0–200 m (Figures 3e 3e and 3f 3f shading). This redistribution pattern implies a weakening of the poleward ocean transport in the historical simulation.</p></div></div><div class="section"><h2 class="section-title">Formulating Tracer Evolution Using Green's Functions</h2><span class="label">3</span><p class="p">Evolution of a passive tracer in the historical simulation is governed by  (9) (9)  ∂ ∂ ∂ ∂ t t + + L L hist hist X X ( ( r r , , t t ) ) = = Ψ Ψ ( ( r r , , t t ) ) , , Ψ Ψ ( ( r r , , t t ) ) = = 0 0  for for  r r ∈ ∈ { { ocean interior ocean interior } } . .  <span class="bold">r</span> is a 3D position vector of the ocean and <span class="italic">t</span> is time. <span class="italic">X</span> is the concentration of a passive tracer and Ψ is its 3D source/sink. All tracers studied here have no source/sink in the ocean interior, therefore we set Ψ to zero everywhere below the surface. At the surface, Ψ Ψ = = F F / / d d z z 1 1 , where F F is air‐sea tracer fluxes, and d <span class="italic">z</span>  <span class="subscript">1</span> the top layer thickness. ( F F has a unit of K m s <span class="superscript">−1</span> for Θ <span class="subscript">e</span> .)</p><div class="section"><h2 class="section-title">Concentration GF Formulation</h2><span class="label">3.1</span><p class="p">The general solution of Equation 9 9 is given in Holzer and Hall ( 2000 2000 ). When <span class="italic">X</span> has zero initial conditions, the solution of Equation 9 9 can be written as a superposition of all tracer pulses emitted from the surface. For concentration BCs, the superposition is given as  (10) (10)  X X ( ( r r , , t t ) ) = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t G G c c r r , , t t ∣ ∣ r r s s , , t t s s X X s s r r s s , , t t s s d d t t s s . .  <span class="italic">X</span>  <span class="superscript">s</span> is <span class="italic">X</span> at the surface. <span class="bold">r</span>  <span class="subscript">s</span> is a surface position vector. <span class="italic">G</span>  <span class="subscript">c</span> is the GF of Equation 9 9 that propagates concentration BCs. Ω denotes the global ocean surface. The two integrals sum up <span class="italic">X</span> ( <span class="bold">r</span> , <span class="italic">t</span> ) emitted from <span class="italic">X</span>  <span class="superscript">s</span> anywhere in Ω and anytime prior to <span class="italic">t</span> .</p><p class="p">Formally <span class="italic">G</span>  <span class="subscript">c</span> is defined as a special solution of Equation 9 9 that satisfies  (11) (11)  ∂ ∂ ∂ ∂ t t + + L L hist hist G G c c r r , , t t ∣ ∣ r r s s , , t t s s = = 0 0 , , G G c c r r , , t t ∣ ∣ r r s s , , t t s s = = δ δ r r − − r r s s δ δ t t − − t t s s  for for  r r ∈ ∈ Ω Ω , , G G c c r r , , 0 0 ∣ ∣ r r s s , , t t s s = = 0 0  for for  r r ∈ ∈ { { ocean interior ocean interior } } . .  <span class="italic">δ</span> is the Dirac delta function.</p></div><div class="section"><h2 class="section-title">Interpretations of Concentration GFs</h2><span class="label">3.2</span><p class="p"><span class="italic">G</span>  <span class="subscript">c</span> can be interpreted from two perspectives. When we fix the surface coordinate ( <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ), <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> ) is a time‐evolving 3D field in the ocean. The 3D field depicts how a tracer injected at ( <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ) spreads in the ocean subject to zero concentration BCs at all other times and surface locations. The BCs remove any tracer that surfaces after <span class="italic">t</span>  <span class="subscript">s</span> , hence we have lim lim τ τ → → ∞ ∞ G G c c = = 0 0 , where <span class="italic">τ</span> = <span class="italic">t</span> − <span class="italic">t</span>  <span class="subscript">s</span> is elapsed time. This perspective is useful for probing GFs from forward simulations in an ocean model (see Section 4 4 ).</p><p class="p">When we fix the field coordinate ( <span class="bold">r</span> , <span class="italic">t</span> ), <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ) is a time‐evolving 2D map of the ocean surface. It shows how sensitive <span class="italic">X</span> ( <span class="bold">r</span> , <span class="italic">t</span> ) is to individual pulses in its surface history <span class="italic">X</span>  <span class="superscript">s</span> . Holzer and Hall ( 2000 2000 ) interpreted the 2D map as a measure of how a tracer injected at ( <span class="bold">r</span> , <span class="italic">t</span> ) surfaces in the time‐reversed flow after <span class="italic">t</span> − <span class="italic">t</span>  <span class="subscript">s</span> . This perspective is useful for inferring GFs from tracer data (see Section 6 6 ). Causality requires that <span class="italic">G</span>  <span class="subscript">c</span> = 0 whenever <span class="italic">t</span> < <span class="italic">t</span>  <span class="subscript">s</span> .</p><p class="p"><span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ) is also referred to as a “joint water‐mass composition and transit‐time distribution” which measures the fraction of water at ( <span class="bold">r</span> , <span class="italic">t</span> ) that has made its last surface contact at location <span class="bold">r</span>  <span class="subscript">s</span> and time <span class="italic">t</span>  <span class="subscript">s</span> (Haine & Hall, 2002 2002 ). Since all the water at ( <span class="bold">r</span> , <span class="italic">t</span> ) can be traced back to the surface eventually, the following must be satisfied.  (12) (12)  ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t G G c c r r , , t t ∣ ∣ r r s s , , t t s s d d t t s s = = 1 1 . .</p><p class="p"><span class="italic">G</span>  <span class="subscript">c</span> has been used to study the transit‐time distribution of the ocean (e.g., Ito & Wang, 2017 2017 ; Maltrud et al., 2010 2010 ; Peacock & Maltrud, 2006 2006 ) and to estimate the ocean's uptake of anthropogenic carbon and heat (Gebbie & Huybers, 2019 2019 ; Khatiwala et al., 2009 2009 ; Newsom et al., 2020 2020 ; Zanna et al., 2019 2019 ).</p></div><div class="section"><h2 class="section-title">Air‐Sea Flux GF Formulation</h2><span class="label">3.3</span><p class="p">The solution of Equation 9 9 can also be written in terms of the air‐sea tracer flux F F X X , when <span class="italic">X</span> has zero initial conditions.  (13) (13)  X X ( ( r r , , t t ) ) = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t G G f f r r , , t t ∣ ∣ r r s s , , t t s s F F X X r r s s , , t t s s d d t t s s  <span class="italic">G</span>  <span class="subscript">f</span> is the boundary GF that propagates the surface source/sink into the ocean. Formally <span class="italic">G</span>  <span class="subscript">f</span> is defined as a special solution of Equation 9 9 that satisfies  (14) (14)  ∂ ∂ ∂ ∂ t t + + L L hist hist G G f f r r , , t t ∣ ∣ r r s s , , t t s s = = 1 1 d d z z 1 1 δ δ r r − − r r s s δ δ t t − − t t s s , , G G f f r r , , 0 0 ∣ ∣ r r s s , , t t s s = = 0 0  every where every where . . Note that Equation 14 14 does not impose zero concentration BCs as Equation 11 11 , hence tracers are not removed when they surface. <span class="italic">G</span>  <span class="subscript">f</span> has been used to probe atmosphere transports (Holzer, 1999 1999 ) and to define a tracer age (Holzer & Hall, 2000 2000 ).</p></div><div class="section"><h2 class="section-title">Limitation of Boundary GFs</h2><span class="label">3.4</span><p class="p">We want to stress that <span class="italic">G</span>  <span class="subscript">c</span> and <span class="italic">G</span>  <span class="subscript">f</span> are both <span class="italic">boundary</span> GFs; that is they only account for tracers emitted from the surface. The redistributed temperature Θ <span class="subscript">r</span> cannot be accounted for using <span class="italic">G</span>  <span class="subscript">c</span> or <span class="italic">G</span>  <span class="subscript">f</span> because it has non‐zero source below the surface (Equation 7 7 ).</p></div></div><div class="section"><h2 class="section-title">Simulating GFs in an Ocean Model</h2><span class="label">4</span><div class="section"><h2 class="section-title">Approximations of Simulated GFs</h2><span class="label">4.1</span><p class="p">The boundary GFs, <span class="italic">G</span>  <span class="subscript">c</span> and <span class="italic">G</span>  <span class="subscript">f</span> , can be generated for an ocean model by simulating passive tracers in it. By definition, we need to compute a GF for every possible ( <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ), which is computationally demanding. To reduce computational cost, we make the following approximations.</p><p class="p">First, we assume that ocean transports are constant. Taking <span class="italic">G</span>  <span class="subscript">c</span> as an example, this assumption means: (a) <span class="italic">G</span>  <span class="subscript">c</span> is the same for <span class="italic">L</span>  <span class="subscript">ctrl</span> and <span class="italic">L</span>  <span class="subscript">hist</span> , (b) <span class="italic">G</span>  <span class="subscript">c</span> does not depend on <span class="italic">t</span>  <span class="subscript">s</span> , hence <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ) = <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> − <span class="italic">t</span>  <span class="subscript">s</span> | <span class="bold">r</span>  <span class="subscript">s</span> , 0). Note that <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> − <span class="italic">t</span>  <span class="subscript">s</span> | <span class="bold">r</span>  <span class="subscript">s</span> , 0) only needs to be solved once (at <span class="italic">t</span>  <span class="subscript">s</span> = 0) for every <span class="bold">r</span>  <span class="subscript">s</span> . The constant‐transport assumption neglects variability and forced‐change in ocean transports; we refer to the resulting errors as a “unforced‐transport error” and a “forced‐transport error,” respectively.</p><p class="p">Second, we assume that the boundary terms, <span class="italic">X</span>  <span class="superscript">s</span> and F F X X , are dominated by large‐scale patterns, hence we can approximate tracers emitted from them using coarse‐grained GFs. Specifically, we derive GFs using surface patches defined in Figure 4 4 . For <span class="italic">G</span>  <span class="subscript">c</span> , we divide the global ocean into 27 regions based on the climatological surface densities in HadCM3, similar to Khatiwala et al. ( 2009 2009 ). For <span class="italic">G</span>  <span class="subscript">f</span> , we divide the global ocean into 20° latitude bands for each basin (20 patches in total). This step greatly reduces the dimension of GFs at the surface (the dimension of <span class="bold">r</span>  <span class="subscript">s</span> is about 1 × 10 <span class="superscript">4</span> in a 1° × 1° model). <span class="italic">X</span>  <span class="superscript">s</span> and F F X X are averaged onto the corresponding patches when convolved with GFs.</p><div class="figure"><div class="figure-label">Figure 4</div><div class="figure-caption">Surface patches for simulating boundary Green's functions Surface patches for simulating boundary Green's functions <span class="italic">G</span>  <span class="subscript">c</span> and <span class="italic">G</span>  <span class="subscript">f</span> . Shading indicates the patch index. <span class="italic">G</span>  <span class="subscript">c</span> propagates concentration boundary conditions, while <span class="italic">G</span>  <span class="subscript">f</span> propagates surface sources/sinks.</div><div class="graphic"></div></div><p class="p">Finally, we approximate the Dirac delta function in Equations 11 11 and 14 14 using a boxcar (rectangular) function with a unit height. The boxcar function lasts for 1 year after it is activated, so that the resulting GFs capture the effect of ocean transports averaged over a year, not that of a particular month. Using surface patches and the boxcar function neglects the covariance between GFs and the boundary terms within patches and years. We refer to this error as a “patch error.”</p></div><div class="section"><h2 class="section-title">Defining Simulated GFs</h2><span class="label">4.2</span><p class="p">GFs resulting from the above approximations are referred to as simulated GFs. Formally simulated concentration GF <span class="italic">G</span>  <span class="subscript">c</span> (denoted as G G ^ ^ c c ) is defined as  (15) (15)  ∂ ∂ ∂ ∂ t t + + L L ctrl ctrl G G ^ ^ c c ( ( r r , , t t ∣ ∣ p p , , 0 0 ) ) = = 0 0 , , G G ^ ^ c c ( ( r r , , t t ∣ ∣ p p , , 0 0 ) ) = = M M c c ( ( r r , , p p ) ) M M t t ( ( t t , , 0 0 ) ) for for  r r ∈ ∈ Ω Ω , , G G ^ ^ c c ( ( r r , , 0 0 ∣ ∣ p p , , 0 0 ) ) = = 0 0  for for  r r ∈ ∈ { { ocean interior ocean interior } } . . The boxcar function <span class="italic">M</span>  <span class="subscript"><span class="italic">t</span></span> ( <span class="italic">t</span> , 0) is activated when <span class="italic">t</span> > 0 and switched off after 1 year. <span class="italic">t</span> = 0 is assigned to the beginning of the control experiment. <span class="italic">M</span>  <span class="subscript">c</span> is a mask function that returns unity if <span class="bold">r</span> is within the surface patch <span class="italic">p</span> and zero otherwise. Ω denotes the global ocean surface. Similarly, simulated air‐sea flux GF <span class="italic">G</span>  <span class="subscript">f</span> (denoted as G G ^ ^ f f ) is defined as  (16) (16)  ∂ ∂ ∂ ∂ t t + + L L ctrl ctrl G G ^ ^ f f ( ( r r , , t t ∣ ∣ p p , , 0 0 ) ) = = 1 1 d d z z 1 1 M M f f ( ( r r , , p p ) ) M M t t ( ( t t , , 0 0 ) ) , , G G ^ ^ f f ( ( r r , , 0 0 ∣ ∣ p p , , 0 0 ) ) = = 0 0  every where every where . .  <span class="italic">M</span>  <span class="subscript">f</span> is a different mask function than <span class="italic">M</span>  <span class="subscript">c</span> , because we use different surface patches to define G G ^ ^ f f and G G ^ ^ c c (Figure 4 4 ). G G ^ ^ c c and G G ^ ^ f f are solved by integrating Equations 15 15 and 16 16 , respectively, in the control experiment for 200 years (from 1860).</p></div><div class="section"><h2 class="section-title">Estimating Tracers Using Simulated GFs</h2><span class="label">4.3</span><p class="p">Simulated GFs can be used to compute the boundary response of a passive tracer following  (17) (17)  X X ^ ^ ( ( r r , , l l ) ) = = ∑ ∑ p p ∑ ∑ l l s s ≤ ≤ l l G G ^ ^ c c r r , , l l − − l l s s ∣ ∣ p p , , 0 0 X X ^ ^ s s p p , , l l s s , ,   (18) (18)  X X ^ ^ ( ( r r , , l l ) ) = = ∑ ∑ p p ∑ ∑ l l s s ≤ ≤ l l G G ^ ^ f f r r , , l l − − l l s s ∣ ∣ p p , , 0 0 F F ^ ^ X X p p , , l l s s . . All quantities in Equations 17 17 and 18 18 are defined on a yearly grid. X X ^ ^ s s and F F ^ ^ X X are <span class="italic">X</span>  <span class="superscript">s</span> and F F X X averaged onto the corresponding patches, respectively. <span class="italic">p</span> is surface patch index and <span class="italic">l</span> is year number. To reduce the unforced‐transport error, we simulate GFs from four initial conditions (1860, 1870, 1880, and 1890 of the control experiment), and use their ensemble means (denoted by “[ ]”) in Equations 17 17 and 18 18 .</p><p class="p">We introduce ∑ ∑ G G ^ ^ χ χ ^ ^ s s as a shorthand for ∑ ∑ p p ∑ ∑ l l s s ≤ ≤ l l G G ^ ^ r r , , l l − − l l s s | | p p , , 0 0 χ χ ^ ^ s s p p , , l l s s . Using this notation, the G G ^ ^ c c estimate of Θ <span class="subscript">e</span> can be written as Θ Θ ^ ^ e e = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s (substitute Θ <span class="subscript">e</span> for <span class="italic">X</span> in Equation 17 17 ), where Θ Θ ^ ^ e e s s is Θ <span class="subscript">e</span> at the surface averaged onto patches. Similarly, the G G ^ ^ c c estimate of Θ Θ e e ∗ ∗ can be written as Θ Θ ^ ^ e e ∗ ∗ = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s ∗ ∗ .</p></div><div class="section"><h2 class="section-title">Error Definitions</h2><span class="label">4.4</span><p class="p">Θ Θ ^ ^ e e is inaccurate because of the patch, unforced‐transport and forced‐transport errors. We quantify these errors using Equations (19) (19) , (20) (20) , (21) (21) . Because Θ Θ e e ∗ ∗ is not affected by forced change in ocean transports, we use it to isolate the patch and unforced‐transport errors. We note that different members of G G ^ ^ c c give similar estimates of Θ Θ e e ∗ ∗ for large‐scale changes examined in Section 5 5 ; the spread is <20% compared to the ensemble mean in most regions (not shown). Similarly, Maltrud et al. ( 2010 2010 ) suggested that the first moment of G G ^ ^ c c (i.e., mean age) can be robustly estimated using just a few members. We therefore assume that the G G ^ ^ c c estimate of Θ Θ e e ∗ ∗ , that is ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s ∗ ∗ , is dominated by the patch error (Equation 19 19 , Θ Θ e e ∗ ∗ without “^” is the model truth). The change of the G G ^ ^ c c estimate resulting from replacing G G ^ ^ c c with G G ^ ^ c c (a single realization) gives the unforced‐transport error (Equation 20 20 ). A larger ensemble of G G ^ ^ c c is useful to refine the unforced‐transport error; however, it is unlikely to change the error substantially (e.g., by a factor of two).  (19) (19)  p p a a t t c c h h _ _ e e r r r r o o r r = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s ∗ ∗ − − Θ Θ e e ∗ ∗   (20) (20)  u u n n f f o o r r c c e e d d _ _ t t r r a a n n s s p p o o r r t t _ _ e e r r r r o o r r = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s ∗ ∗ − − ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s ∗ ∗</p><p class="p">Because Θ <span class="subscript">e</span> is evolved by the historical ocean transport, we use it to compute the forced‐transport error. The G G ^ ^ c c estimate of Θ <span class="subscript">e</span> , that is ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s , is affected by the patch and forced‐transport error; the patch error is solved in Equation 19 19 , therefore the forced‐transport error is given as Equation 21 21 .  (21) (21)  f f o o r r c c e e d d _ _ t t r r a a n n s s p p o o r r t t _ _ e e r r r r o o r r = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s − − Θ Θ e e − − p p a a t t c c h h _ _ e e r r r r o o r r</p><p class="p">In practice, there is also a “BC error” when estimating Θ <span class="subscript">e</span> using G G ^ ^ c c . This is because surface excess temperature Θ Θ e e s s is poorly known. Using SST anomaly Θ Θ a a s s to approximate Θ Θ e e s s is not accurate because Θ Θ a a s s is contaminated by redistributed temperature. We compute the BC error by replacing Θ Θ e e s s with Θ Θ a a s s in the G G ^ ^ c c estimate (Equation 22 22 ).  (22) (22)  B B C C _ _ e e r r r r o o r r = = ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ a a s s − − ∑ ∑ G G ^ ^ c c Θ Θ ^ ^ e e s s . .</p><p class="p">We compute the errors for the G G ^ ^ f f estimate (Equation 18 18 ) in a similar way as for the G G ^ ^ c c estimate (Equation 17 17 ). The only difference is that the boundary term F F X X is the same for Θ Θ e e ∗ ∗ and Θ <span class="subscript">e</span> in the G G ^ ^ f f estimate by definition.</p></div><div class="section"><h2 class="section-title">Surface Concentration BCs</h2><span class="label">4.5</span><p class="p">Θ Θ e e s s ∗ ∗ , Θ Θ e e s s and Θ Θ a a s s are supplied as anomalies relative to 1860–1880 when evaluating Equation 17 17 . This step is to exclude a shock in Θ Θ e e s s (+0.15°C in global mean) shortly after the start of the historical simulation. Because Θ Θ e e s s ∗ ∗ does not show a similar behavior, we suspect that the shock is due to an abrupt change in ocean transports. If not removed, the shock would cause a warm bias in the G G ^ ^ c c estimate of Θ <span class="subscript">e</span> , because G G ^ ^ c c is derived from the control experiment. Since this warm bias can be removed easily, we do not count it as a forced‐transport error.</p><p class="p">A comparison between Θ Θ a a s s , Θ Θ e e s s and Θ Θ e e s s ∗ ∗ is shown in Figure 5 5 for the 1999–2008 average. Θ Θ a a s s (black line) consistently has less warming than Θ Θ e e s s (red line) in the Southern Ocean and the North Atlantic (north of 40°N) by as much as 2°C (Figures 5a 5a and 5b 5b ). This difference is likely caused by a reduction of convection and a slow down of the Atlantic meridional overturning circulation, as shown in Gregory et al. ( 2016 2016 ).</p><div class="figure"><div class="figure-label">Figure 5</div><div class="figure-caption">Surface temperature anomaly Surface temperature anomaly Θ Θ a a s s and surface excess temperature ( Θ Θ e e s s and Θ Θ e e s s ∗ ∗ ). Θ Θ e e s s ∗ ∗ is the same as Θ Θ e e s s except that it is evolved by the control ocean transport instead of the historical one. Values shown are differences between 1999–2008 and 1860–1880. (a and b) Zonal average over a basin. (c and d) Spatial map.</div><div class="graphic"></div></div><p class="p">Θ Θ e e s s (red line) and Θ Θ e e s s ∗ ∗ (blue line) are very similar at most latitudes (Figures 5a 5a and 5b 5b ). The exception is the North Pacific and the North Atlantic, where Θ Θ e e s s is much warmer than Θ Θ e e s s ∗ ∗ . This implies a reduction of the ocean's surface‐to‐interior transport in those regions during the historical simulation (because global warming stratifies the ocean and thus inhibits heat uptake).</p></div><div class="section"><h2 class="section-title">Potential Nonlinear Errors</h2><span class="label">4.6</span><p class="p">Equation 19 19 assumes that the function Φ is strictly linear when operating on passive tracers in models. This is not necessarily true because some models use flux‐limited transport schemes, which makes Φ nonlinear even when operating on passive tracers. This nonlinear error is included in the error computed from Equation 19 19 , but it is likely small compared to the patch error.</p><p class="p">Excess temperature Θ <span class="subscript">e</span> can alternatively be defined as a dynamical tracer that affects ocean transports (i.e., replacing <span class="italic">L</span>  <span class="subscript">hist</span> with Φ in Equation 6 6 ). This definition leads to a set of “dynamical” GFs, as opposed to “passive” GFs of Section 3 3 (their distinctions are further discussed in Appendix B B ). The GF estimate of the dynamical Θ <span class="subscript">e</span> (Equation B1 B1 ) contains a nonlinear error because the dynamical ocean response is not a linear function of the forcing. In contrast, the GF estimate of the passive Θ <span class="subscript">e</span> (Equation 6 6 ) does not have a nonlinear error, because Equation 6 6 is strictly linear. The errors introduced in Section 4.1 4.1 can all be eliminated by simulating GFs for Equation 6 6 at very fine space and time resolution. The nonlinear error, however, cannot be eliminated by any means.</p></div></div><div class="section"><h2 class="section-title">Estimating Excess Heat Using Simulated GFs</h2><span class="label">5</span><p class="p">In this section, we examine how well simulated GFs can reproduce excess heat changes in the historical simulation. The inaccuracy is partitioned into the patch, unforced‐transport, forced‐transport and BC errors (Equations (19) (19) , (20) (20) , (21) (21) , (22) (22) ).</p><p class="p">We focus on three metrics when comparing the model truth with the GF estimates: (a) global/basin volume integral (0–2,000 m), (b) zonal‐and‐depth integral (0–2,000 m), and (c) depth distribution of (b) (0–1500 m). Metric (a) is shown as anomalies relative to 1946–1955. Metrics (b) and (c) are shown as changes between 1999–2008 and 1946–1955 (denoted using “Δ”). The root‐mean‐square error (RMSE) of the GF estimate (total error) and the RMS value for each error source (Equations (19) (19) , (20) (20) , (21) (21) , (22) (22) ) are listed in Figures 6 6 , 7 7 , 8 8 . Each realization of GFs gives an unforced‐transport error; we report the unforced‐transport error averaged over four realizations. Since our metrics are all extensive quantities, we also report their normalized RMSEs; that is the ratio between RMSE and root‐mean‐square magnitude (RMSM).</p><div class="figure"><div class="figure-label">Figure 6</div><div class="figure-caption">Estimating the global/basin integrated (0–2,000 m) excess heat Estimating the global/basin integrated (0–2,000 m) excess heat H H e e and H H e e ∗ ∗ in the historical simulation using simulated Green's functions (GFs) (Sections 5.1 5.1 and 5.2 5.2 ). Black and gray lines show H H e e ∗ ∗ and H H e e in HadCM3, respectively. H H e e ∗ ∗ is the same as H H e e except that it is evolved by the control ocean transport. Blue and green lines are the G G ^ ^ c c estimates of H H e e ∗ ∗ and H H e e , respectively. The G G ^ ^ f f estimates of H H e e ∗ ∗ and H H e e are identical and both shown by red lines. The root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square errors (RMSEs) of different GF estimates are listed. The RMS values of the patch, unforced‐transport and forced‐transport errors are listed for the G G ^ ^ c c and G G ^ ^ f f estimates from left to right. The two G G ^ ^ f f estimates have different RMSEs because H H e e ∗ ∗ and H H e e are different in the model truth.</div><div class="graphic"></div></div><div class="figure"><div class="figure-label">Figure 7</div><div class="figure-caption">Estimating latitude distribution of excess heat change Estimating latitude distribution of excess heat change Δ Δ H H e e and Δ Δ H H e e ∗ ∗ in the historical simulation using G G ^ ^ c c (Section 5.1 5.1 ). (a and b) Zonal‐and‐depth integral (0–2,000 m). (c–f) Depth distribution of panels (a and b). In all panels, black and gray lines show Δ Δ H H e e ∗ ∗ and Δ Δ H H e e in HadCM3, respectively; blue and green lines show the G G ^ ^ c c estimates of Δ Δ H H e e ∗ ∗ and Δ Δ H H e e , respectively. Shading in panels (c and d) indicates errors in the G G ^ ^ c c estimate of Δ Δ H H e e ∗ ∗ (the patch error). Shading in panels (e and f) indicates errors in the G G ^ ^ c c estimate of Δ Δ H H e e minus the patch error (the forced‐transport error). For each metric, the root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square error (RMSE) of the G G ^ ^ c c estimate are listed, along with the RMS values of the patch, unforced‐transport and forced‐transport errors. All changes are calculated as differences between 1999–2008 and 1946–1955.</div><div class="graphic"></div></div><div class="figure"><div class="figure-label">Figure 8</div><div class="figure-caption">Estimating latitude distribution of excess heat change Estimating latitude distribution of excess heat change Δ Δ H H e e and Δ Δ H H e e ∗ ∗ in the historical simulation using G G ^ ^ f f (Section 5.2 5.2 ). (a and b) Zonal‐and‐depth integral (0–2,000 m). (c–f) Depth distribution of panels (a and b). In all panels, black and gray lines show Δ Δ H H e e ∗ ∗ and Δ Δ H H e e in HadCM3, respectively; the G G ^ ^ f f estimates of Δ Δ H H e e ∗ ∗ and Δ Δ H H e e are identical, and shown by red lines. Shading in panels (c and d) indicates errors in the G G ^ ^ f f estimate of Δ Δ H H e e ∗ ∗ (the patch error). Shading in panels (e and f) indicates errors in the G G ^ ^ f f estimate of Δ Δ H H e e minus the patch error (the forced‐transport error). For each metric, the root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square error (RMSE) of the G G ^ ^ f f estimate are listed, along with the RMS values of the patch, unforced‐transport and forced‐transport errors. The two G G ^ ^ f f estimates have different RMSEs because H H e e ∗ ∗ and H H e e are different in the model truth. All changes are calculated as differences between 1999–2008 and 1946–1955.</div><div class="graphic"></div></div><div class="section"><h2 class="section-title">Concentration GF Estimate</h2><span class="label">5.1</span><p class="p">In this subsection, we evaluate the GF estimate of H H e e and H H e e ∗ ∗ based on Equation 17 17 (referred to as the G G ^ ^ c c estimate). H H e e ∗ ∗ is the same as H H e e except that it is evolved by the control ocean transport (see Section 2.4 2.4 ). G G ^ ^ c c is simulated in the control experiment. The BCs Θ Θ e e s s and Θ Θ e e s s ∗ ∗ are diagnosed in HadCM3 (i.e., BCs are perfectly known). Θ <span class="subscript">e</span> and Θ Θ e e ∗ ∗ are converted to excess heat H H e e and H H e e ∗ ∗ , respectively, following the procedure of Section 2.2.4 2.2.4 . We exclude H H e e and H H e e ∗ ∗ resulting from the Arctic patch to be consistent with Zanna et al. ( 2019 2019 ).</p><div class="section"><h2 class="section-title">Patch and Unforced‐Transport Errors</h2><span class="label">5.1.1</span><p class="p">We start with H H e e ∗ ∗ . The G G ^ ^ c c estimate of H H e e ∗ ∗ is inaccurate because of the patch error. For all metrics, the RMS value of the unforced‐transport error is less than 1/3 of the patch error (compare numbers in Figures 6 6 and 7 7 ). The global integrated H H e e ∗ ∗ (black line) increases by about 300 ZJ over 1860–2008, of which two thirds are stored in the Indo‐Pacific and one third in the Atlantic (Figure 6 6 ). For this metric, the G G ^ ^ c c estimate (blue line) reproduces the model truth well, with a RMSE of 16 ZJ for the global integral and 8 ZJ for basin integrals (Figure 6 6 ).</p><p class="p">The zonal‐and‐depth integrated Δ Δ H H e e ∗ ∗ (black line) has a RMSM of 13.6 PJ m <span class="superscript">−1</span> in the Indo‐Pacific and 6.2 PJ m <span class="superscript">−1</span> in the Atlantic, averaged over latitudes (Figures 7a 7a and 7b 7b ). The G G ^ ^ c c estimate of this metric (blue line) has an error of 24% in the Indo‐Pacific and 42% in the Atlantic (Figures 7a 7a and 7b 7b ). The patch error is most evident in the North Atlantic (underestimate) and in the Southern Ocean (overestimate) (Figures 7a 7a and 7b 7b , compare black and blue lines).</p><p class="p">The latitude‐depth pattern of Δ Δ H H e e ∗ ∗ (black contour) has a RMSM of 14.9 TJ m <span class="superscript">−2</span> in the Indo‐Pacific and 5.2 TJ m <span class="superscript">−2</span> in the Atlantic, averaged over latitudes and 0–1,500 m (Figures 7c 7c and 7d 7d ). The G G ^ ^ c c estimate of this metric (blue contour) has an error of 26% in the Indo‐Pacific and 44% in the Atlantic (Figures 7c 7c and 7d 7d ). The patch error is strongest in the upper 200 m (Figures 7c 7c and 7d 7d shading). Below that, the G G ^ ^ c c estimate follows the model truth broadly, except in the Atlantic around 60°N (Figures 7c 7c and 7d 7d , compare black and blue contours).</p></div><div class="section"><h2 class="section-title">Forced‐Transport Error</h2><span class="label">5.1.2</span><p class="p">We next examine the G G ^ ^ c c estimate of H H e e . By definition, this estimate is inaccurate because of the patch and forced‐transport errors; we subtract the patch error (Section 5.1.1 5.1.1 ) from the total error to derive the forced‐transport error (Equation 21 21 ). Global warming stratifies the ocean and weakens the surface‐to‐interior transport. The forced‐transport error arises because G G ^ ^ c c does not capture this weakening effect, hence tends to overestimate warming at depths. This is evident in Figure 6 6 ; the G G ^ ^ c c estimate (green line) overestimates H H e e (gray line) in both global and basin integrals. The overestimate is strongest at northern mid latitudes (Figures 7e 7e and 7f 7f shading).</p><p class="p">In the North Atlantic, the forced‐transport error is associated with a 1 Sv slowdown of the overturning circulation at 45°N after 1960 (not shown). In contrast, the overturning circulation shows little change compared to the control in the North Pacific, implying the forced‐transport error there is associated with parameterized transports. Interestingly, the forced‐transport error is nearly zero in the Southern Ocean. This is probably because the Southern Ocean circulation has a strong wind‐driven component (Marshall & Speer, 2012 2012 ), hence is less sensitive to surface warming compared to the North Atlantic circulation.</p><p class="p">The forced‐transport error is more than twice as large as the patch error for global/basin integrated H H e e (Figure 6 6 ), and about the same size as the patch error for zonal integrated Δ Δ H H e e (Figure 7 7 ). The patch and forced‐transport errors partially compensate each other for zonal integrated Δ Δ H H e e in some regions (Figure 7 7 , compare middle and bottom row shading), hence the RMSE of the G G ^ ^ c c H H e e estimate is only slightly larger than that of the G G ^ ^ c c H H e e ∗ ∗ estimate in Figure 7 7 .</p></div></div><div class="section"><h2 class="section-title">Air‐Sea Flux GF Estimate</h2><span class="label">5.2</span><p class="p">In this subsection, we evaluate the GF estimates of H H e e and H H e e ∗ ∗ based on Equation 18 18 (referred to as the G G ^ ^ f f estimate). G G ^ ^ f f is simulated in the control experiment. The BCs F F Θ Θ e e are diagnosed in HadCM3 as ( <span class="italic">Q</span>  <span class="subscript">ERF</span> + <span class="italic">Q</span> ′)/( <span class="italic">ρ</span>  <span class="subscript">0</span>  <span class="italic">c</span>  <span class="subscript"><span class="italic">p</span></span> ). F F Θ Θ e e ∗ ∗ is the same as F F Θ Θ e e by definition, therefore the G G ^ ^ f f estimates of H H e e and H H e e ∗ ∗ are identical. Θ <span class="subscript">e</span> and Θ Θ e e ∗ ∗ are converted to excess heat H H e e and H H e e ∗ ∗ , respectively, following the procedure of Section 2.2.4 2.2.4 .</p><p class="p">The G G ^ ^ f f estimate has smaller RMSEs than the G G ^ ^ c c estimate for global/basin integrals (Figure 6 6 ) and zonal‐and‐depth integrals (Figures 7 7 and 8 8 , top row). In particular, the unforced‐ and forced‐transport errors of the G G ^ ^ f f estimate are much smaller than those of the G G ^ ^ c c estimate. Note that the basin integrated H H e e ∗ ∗ and H H e e are largely determined by their surface fluxes, which are directly supplied to the G G ^ ^ f f estimate.</p><p class="p">In contrast, the G G ^ ^ f f estimate is less accurate than the G G ^ ^ c c estimate for the latitude‐depth patterns of Δ Δ H H e e ∗ ∗ and Δ Δ H H e e in the Indo‐Pacific (compare Figure 7 7 with Figure 8 8 for (c) and (e)). This is because the G G ^ ^ f f estimate has a larger patch error, especially in 0–200 m (compare shading in Figure 7c 7c with Figure 8c 8c ). In the Atlantic, the G G ^ ^ f f and G G ^ ^ c c estimates have similar RMSEs for the latitude‐depth patterns of Δ Δ H H e e ∗ ∗ and Δ Δ H H e e , but the forced‐transport error is smaller in the G G ^ ^ f f estimate, especially below 200 m (compare shading in Figure 7f 7f with Figure 8f 8f ).</p></div><div class="section"><h2 class="section-title">GF Estimate in a Real‐World Application</h2><span class="label">5.3</span><p class="p">In this subsection, we simulate a real‐world application of the GF method in the model world. Specifically, we estimate excess heat H H e e in the historical simulation using: (a) simulated Θ Θ a a s s and (b) G G ^ ^ c c derived from HadCM3. This setup corresponds to Zanna et al. ( 2019 2019 ) who reconstructed the real‐world H H e e by combining: (a) observed Θ Θ a a s s and (b) G G ^ ^ c c derived from an ocean model. To distinguish the Θ Θ e e s s ‐based G G ^ ^ c c estimate (examined in Section 5.1 5.1 ) from the Θ Θ a a s s ‐based G G ^ ^ c c estimate (to be examined below), we refer to the latter as the G G ^ ^ c c + + estimate. The G G ^ ^ c c + + estimate suffers an additional BC error compared to the G G ^ ^ c c estimate, because of the differences between Θ Θ e e s s and Θ Θ a a s s (see Section 4.5 4.5 ).</p><div class="section"><h2 class="section-title">BC Error</h2><span class="label">5.3.1</span><p class="p">The BC error is the largest error for the latitude‐depth pattern of Δ Δ H H e e (Figures 9e 9e and 9f 9f ); it is as large as the forced‐transport error for basin integrated H H e e (Figures 9a 9a and 9b 9b ) and depth integrated Δ Δ H H e e (Figures 9c 9c and 9d 9d ). For zonal‐and‐depth integrated Δ Δ H H e e , the BC error causes an underestimate in most of the Atlantic and south of 40°S of the Indo‐Pacific (Figures 9c 9c and 9d 9d , compare orange and green lines). In the Southern Ocean, the underestimate caused by the BC error partially compensates the overestimate caused by the patch and forced‐transport errors, reducing the total error there.</p><div class="figure"><div class="figure-label">Figure 9</div><div class="figure-caption">Estimating excess heat Estimating excess heat H H e e in the historical simulation using G G ^ ^ c c and Θ Θ a a s s (Section 5.3 5.3 ). This estimate is referred to as the G G ^ ^ c c + + estimate. (a and b) Basin‐volume integral. (c and d) Zonal‐and‐depth integrated change (0–2,000 m). (e and f) Depth distribution of panels (c and d). In all panels, black lines are the model truth, orange lines are the G G ^ ^ c c + + estimate, and green lines are the G G ^ ^ c c estimate in Figures 6 6 and 7 7 . Shading in panels (e and f) indicates the boundary condition (BC) error (Equation 22 22 ). For each metric, the root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square errors (RMSEs) of the two Green's function estimates are listed, along with the RMS values of the patch, forced‐change and BC errors.</div><div class="graphic"></div></div></div><div class="section"><h2 class="section-title">Total Error</h2><span class="label">5.3.2</span><p class="p">When all error terms are considered, the G G ^ ^ c c + + estimate (orange line) reconstructs the model truth (black line) with an error of 48% and 39% for basin integrated H H e e in the Indo‐Pacific and Atlantic, respectively (Figures 9a 9a and 9b 9b ). In the Indo‐Pacific, the total error is 26% for zonal‐and‐depth integrated Δ Δ H H e e and 39% for its depth distribution (Figures 9c 9c and 9e 9e ). These numbers are larger in the Atlantic, at 37% and 68%, respectively (Figures 9d 9d and 9f 9f ). For depth‐integrated Δ Δ H H e e , the largest error occurs at mid and high latitudes, for example, an overestimate in the North Pacific (Figures 9c 9c and 9d 9d , compare black and orange lines).</p></div></div></div><div class="section"><h2 class="section-title">Inferring GFs From Tracer Data</h2><span class="label">6</span><div class="section"><h2 class="section-title">Introducing the Inverse Problem</h2><span class="label">6.1</span><p class="p">The GF model Equation 10 10 connects <span class="italic">X</span> at ( <span class="bold">r</span> , <span class="italic">t</span> ) with its surface history <span class="italic">X</span>  <span class="superscript">s</span> via <span class="italic">G</span>  <span class="subscript">c</span> at <span class="bold">r</span> . This forms a constraint on <span class="italic">G</span>  <span class="subscript">c</span> at <span class="bold">r</span> for every pair of <span class="italic">X</span> ( <span class="bold">r</span> , <span class="italic">t</span> ) and <span class="italic">X</span>  <span class="superscript">s</span> in observations. In this section, we introduce a method to infer <span class="italic">G</span>  <span class="subscript">c</span> from such constraints. This problem is the “inverse” of the forward problem discussed in Section 5 5 , which uses <span class="italic">X</span>  <span class="superscript">s</span> and <span class="italic">G</span>  <span class="subscript">c</span> at <span class="bold">r</span> to estimate <span class="italic">X</span> ( <span class="bold">r</span> , <span class="italic">t</span> ). Inferring <span class="italic">G</span>  <span class="subscript">c</span> is useful as it only requires tracer data; for example, one can use it to estimate the real‐world <span class="italic">G</span>  <span class="subscript">c</span> from observed tracers.</p><p class="p">Observations are insufficient constraints on <span class="italic">G</span>  <span class="subscript">c</span> . We assume that ocean transports are constant to reduce the number of unknowns in <span class="italic">G</span>  <span class="subscript">c</span> . This allows us to rewrite <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , <span class="italic">t</span> , | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> ) as <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , 0, | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">t</span>  <span class="subscript">s</span> − <span class="italic">t</span> ) and rewrite Equation 10 10 as  (23) (23)  X X n n r r , , t t n n = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t n n G G c c r r , , 0 0 ∣ ∣ r r s s , , t t s s − − t t n n X X n n s s r r s s , , t t s s d d t t s s . .  <span class="italic">n</span> is an index for different observations; <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> is the time of the <span class="italic">n</span> th observation. For example, one can assign <span class="italic">n</span> = 1 to CFC‐11 observed at year 1994, <span class="italic">n</span> = 2 to CFC‐12 at year 2000 and <span class="italic">n</span> = 3 to CFC‐12 at year 1994. Note that <span class="italic">G</span>  <span class="subscript">c</span> in Equation 23 23 depends on <span class="italic">t</span>  <span class="subscript"><span class="italic">s</span></span> − <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> , not <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> alone, which is different from <span class="italic">G</span>  <span class="subscript">c</span> in Equation 10 10 . Causality requires that <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , 0 | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">τ</span> ) = 0 for <span class="italic">τ</span> > 0, where <span class="italic">τ</span> = <span class="italic">t</span>  <span class="subscript"><span class="italic">s</span></span> − <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> .</p></div><div class="section"><h2 class="section-title">Maximum Entropy Method</h2><span class="label">6.2</span><p class="p">At every <span class="bold">r</span> , <span class="italic">N</span> observations of <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> and X X n n s s impose <span class="italic">N</span> constraints on <span class="italic">G</span>  <span class="subscript">c</span> via Equation 23 23 . In practice, <span class="italic">N</span> is much smaller than the number of unknowns in <span class="italic">G</span>  <span class="subscript">c</span> ; the latter is at least the number of locations in <span class="bold">r</span>  <span class="subscript">s</span> . Among infinitely many <span class="italic">G</span>  <span class="subscript">c</span> that satisfy constraints, we choose the one that is the most “similar” to an initial guess of <span class="italic">G</span>  <span class="subscript">c</span> (denoted as <span class="italic">G</span>  <span class="subscript">pr</span> ). This method is called the Maximum Entropy (MaxEnt) method and was first applied to infer <span class="italic">G</span>  <span class="subscript">c</span> by Khatiwala et al. ( 2009 2009 ) and Holzer et al. ( 2010 2010 ). Formally, the above procedure can be cast as a constrained optimization problem, and solved using the method of Lagrangian multipliers.</p><p class="p">Given <span class="italic">N</span> observations of tracers at <span class="bold">r</span> , <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> ( <span class="bold">r</span> , <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> ), <span class="italic">n</span> = 1, …, <span class="italic">N</span> , the MaxEnt estimate of <span class="italic">G</span>  <span class="subscript">c</span> is a function of X X n n s s and <span class="italic">G</span>  <span class="subscript">pr</span>   (24) (24)  G G M M E E r r , , 0 0 ∣ ∣ r r s s , , τ τ = = 1 1 Z Z G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ exp exp ∑ ∑ n n = = 1 1 N N a a n n X X n n s s r r s s , , t t n n + + τ τ . .  <span class="italic">Z</span> is a normalization factor to ensure that <span class="italic">G</span>  <span class="subscript">ME</span> integrates to unity over the global ocean surface (Ω) and all <span class="italic">τ</span> values, which is required by Equation 12 12 . To determine the <span class="italic">N</span> unknowns ( <span class="italic">a</span>  <span class="subscript">1</span> , …, <span class="italic">a</span>  <span class="subscript"><span class="italic">N</span></span> ), we substitute <span class="italic">G</span>  <span class="subscript">ME</span> and X X n n s s into Equation 23 23   (25) (25)  X X n n ′ ′ r r , , t t n n ∣ ∣ a a 1 1 , , ⋯ ⋯ , , a a N N = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t n n G G M M E E r r , , 0 0 ∣ ∣ r r s s , , t t s s − − t t n n X X n n s s r r s s , , t t s s d d t t s s , , and solve for <span class="italic">a</span>  <span class="subscript">1</span> , …, <span class="italic">a</span>  <span class="subscript"><span class="italic">N</span></span> that minimize the misfit between <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> and X X n n ′ ′ . Formally, the desired <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> is given as  (26) (26)  arg min arg min a a ‖ ‖ x x ′ ′ ( ( a a ) ) − − x x ‖ ‖ 2 2 2 2 + + λ λ ‖ ‖ a a ‖ ‖ 2 2 2 2 , , where <span class="bold">x</span> , <span class="bold">x</span> ′ and <span class="bold">a</span> are column vectors of <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> , X X n n ′ ′ and <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> , respectively. ‖ ⋅ ‖ is the 2‐norm of a vector (i.e., ‖ ‖ a a ‖ ‖ 2 2 2 2 = = a a 1 1 2 2 + + ⋯ ⋯ + + a a N N 2 2 ). Each row of <span class="bold">x</span> ′( <span class="bold">a</span> ) and <span class="bold">x</span> are normalized so that model‐data misfits of different tracers are comparable. The regularization term λ λ ‖ ‖ a a ‖ ‖ 2 2 2 2 is included to prevent overfitting, because there are errors in observations and in Equation 23 23 . We set <span class="italic">λ</span> to unity based on the L‐curve method (Hansen & O’Leary, 1993 1993 ). Derivation of Equation 24 24 , the L‐curve method, and how we choose <span class="italic">λ</span> are described in Appendix C C .</p><p class="p">There are other methods to infer <span class="italic">G</span>  <span class="subscript">c</span> from observations. For example, Gebbie and Huybers ( 2010 2010 ) and DeVries and Primeau ( 2011 2011 ) estimate the operator <span class="italic">L</span> (Equation 9 9 ) from observations. Once <span class="italic">L</span> is derived, one can use it to calculate <span class="italic">G</span>  <span class="subscript">c</span> analytically.</p></div><div class="section"><h2 class="section-title">Transient Tracers in the Ocean</h2><span class="label">6.3</span><div class="section"><h2 class="section-title">Introducing CFCs, SF <span class="subscript">6</span> , and Bomb Δ <span class="superscript">14</span> C</h2><span class="label">6.3.1</span><p class="p">Observations of CFC‐11, CFC‐12, and SF <span class="subscript">6</span> (Fine, 2011 2011 ) are often used as data constraints in the MaxEnt method (i.e., <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> in Equation 23 23 ). CFCs and SF <span class="subscript">6</span> are man‐made chemical tracers that have been released into the atmosphere since the 1930s and gradually taken up by the ocean. CFCs and SF <span class="subscript">6</span> are stable in the oxygenated open ocean. Once entering the ocean, they are advected and diffused by ocean transports, like passive tracers.</p><p class="p">We also explore the use of bomb <span class="superscript">14</span> C as data constraints in the MaxEnt method. <span class="superscript">14</span> C is commonly expressed as Δ <span class="superscript">14</span> C, which is the deviation of the <span class="superscript">14</span> C/ <span class="superscript">12</span> C ratio relative to a standard value. <span class="superscript">14</span> C is naturally generated in the atmosphere by cosmic rays. The <span class="superscript">14</span> C content of a water parcel decays with a half‐life of 5,730 years once it is out of contact with the atmosphere. During the 1950s and 1960s, the nuclear weapon tests dramatically increased Δ <span class="superscript">14</span> C in the atmosphere. This “bomb Δ <span class="superscript">14</span> C” signal invades the ocean in a way similar to CFCs and SF <span class="subscript">6</span> .</p></div><div class="section"><h2 class="section-title">Spatial Distribution</h2><span class="label">6.3.2</span><p class="p">We use results from a historical simulation of CESM2 (Danabasoglu et al., 2020 2020 ) to demonstrate passages of CFCs, SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C in the ocean (Figure 10 10 ). The CESM2 historical simulation is conducted under the CMIP6 protocol (Eyring et al., 2016 2016 ; Orr et al., 2017 2017 ). We derive bomb Δ <span class="superscript">14</span> C as anomalies in Δ <span class="superscript">14</span> C relative to its 1850–1870 climatology. Measurements of CFCs, SF <span class="subscript">6</span> and Δ <span class="superscript">14</span> C from historical cruises are made available as gridded and profile data by Global Ocean Data Analysis Project (GLODAP; Key et al., 2004 2004 ; Olsen et al., 2016 2016 ).</p><div class="figure"><div class="figure-label">Figure 10</div><div class="figure-caption">Transient tracers in the ocean from the CESM2 historical simulation. (a) Sea surface concentrations of CFC‐11, CFC‐12, and SF Transient tracers in the ocean from the CESM2 historical simulation. (a) Sea surface concentrations of CFC‐11, CFC‐12, and SF <span class="subscript">6</span> (solid lines) and their atmosphere mixing ratios (dashed lines). Both quantities are shown as global mean. Dashed lines are multiplied by arbitrary scaling factors. (b and c) CFC‐11 at year 1994 at the surface and the 150°W section (shading and black contours). For these two metrics, CFC‐12 and SF <span class="subscript">6</span> have similar patterns compared to CFC‐11, but with different magnitudes. Panels (d–f) are the same as panels (a–c), but for bomb Δ <span class="superscript">14</span> C. CFC‐11 and bomb Δ <span class="superscript">14</span> C in HadCM3 (Section 6.4 6.4 ) and observations are shown as red and green contours, respectively, in the bottom row. 1 nmol = 1 × 10 <span class="superscript">−9</span> mol.</div><div class="graphic"></div></div><p class="p">Both CFC‐11 and bomb Δ <span class="superscript">14</span> C invade the ocean from the surface, similar to how excess heat is carried to depths, for example, at the 150°W section (Figures 10c 10c and 10f 10f , shading). A major difference between CFC‐11 and <span class="superscript">14</span> C is that the latter has a much longer air‐sea equilibration timescale than the former (10 years vs. weeks) (Broecker & Peng, 1974 1974 ). This has two consequences for CFC‐11 and bomb Δ <span class="superscript">14</span> C in the ocean. First, the surface CFC‐11 (solid line) follows its atmospheric history (dashed line) closely for global mean, while the surface bomb Δ <span class="superscript">14</span> C shows a slower increase and decay compared to its atmospheric history (Figures 10a 10a and 10d 10d ). Second, and more importantly, the surface CFC‐11 and bomb Δ <span class="superscript">14</span> C have very different patterns in the ocean (compare Figures 10b 10b and 10e 10e ), because the pattern of bomb Δ <span class="superscript">14</span> C is more affected by ocean transports (due to slow air‐sea equilibration). CFC‐12 and SF <span class="subscript">6</span> have similar air‐sea equilibration timescales and spatial patterns as CFC‐11.</p></div></div><div class="section"><h2 class="section-title">Simulated Tracer Observations</h2><span class="label">6.4</span><p class="p">To derive <span class="italic">G</span>  <span class="subscript">ME</span> as one would do with observations, we include CFCs, SF <span class="subscript">6</span> , and bomb Δ <span class="superscript">14</span> C in the historical simulation (see Appendix D D for details). The resulting CFC‐11 and bomb Δ <span class="superscript">14</span> C are similar to the gridded GLODAPv1 observations. Taking the 150°W section as an example, this is evident as a good agreement between red and green contours in Figures 10c 10c and 10f 10f . In polar regions, tracers in HadCM3 tend to penetrate to greater depths than those in CESM2, implying that HadCM3 has a stronger convection than CESM2 there. To isolate the forced‐transport error, we also simulate CFCs, SF <span class="subscript">6</span> , and bomb Δ <span class="superscript">14</span> C in the control experiment. In Section 7 7 , we use simulated observations in the historical and control experiments to estimate H H e e and H H e e ∗ ∗ , respectively.</p></div><div class="section"><h2 class="section-title">A Baseline Setup for Computing <span class="italic">G</span>  <span class="subscript">ME</span></h2><span class="label">6.5</span><p class="p">It is important to note that <span class="italic">G</span>  <span class="subscript">ME</span> is not uniquely defined, but depends on the choice of data constraints and priors. Because we want to test the application of <span class="italic">G</span>  <span class="subscript">ME</span> in the real world, we construct a <span class="italic">G</span>  <span class="subscript">ME</span> using HadCM3 equivalents of real‐world observations. We refer to this <span class="italic">G</span>  <span class="subscript">ME</span> as <span class="italic">G</span>  <span class="subscript">MEb</span> .</p><div class="section"><h2 class="section-title">Data Constraints</h2><span class="label">6.5.1</span><p class="p">We use four tracers simulated in HadCM3 to compute <span class="italic">G</span>  <span class="subscript">MEb</span> ; they are CFC‐11 and CFC‐12 at year 1994 and climatological temperature and salinity. These four tracers are available in observations from the gridded GLODAPv1 data (Key et al., 2004 2004 ). We choose this data set because it has a nearly global coverage, hence one could compute <span class="italic">G</span>  <span class="subscript">ME</span> everywhere in the ocean.</p><p class="p">For climatological temperature and salinity, we repeat their surface BCs in time, and truncate the time integral in Equation 25 25 from (− <span class="italic">∞</span> , <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> ] to [ <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> − 7,999, <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> ] years. The 8,000‐year limit is an upper bound of the timescale to tracer equilibrium in the global ocean under concentration BCs. One can set <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> to an arbitrary number for climatological tracers because their <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> and X X n n s s are both constant in time.</p></div><div class="section"><h2 class="section-title">Space and Time Average</h2><span class="label">6.5.2</span><p class="p">All data on the HadCM3 grid are averaged onto a 10° × 10° grid before solving for <span class="italic">G</span>  <span class="subscript">ME</span> . Because every interior point has a <span class="italic">G</span>  <span class="subscript">ME</span> , the spatial averaging reduces the total number of <span class="italic">G</span>  <span class="subscript">ME</span> to be solved. Despite the low resolution, the coarse grid can still capture most of spatial variability in the surface BCs of CFCs, SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C, because they all exhibit coherent spatial structures (Figures 10b 10b and 10e 10e ). On the time dimension, we focus on annually averaged quantities as for simulated GFs (Sections 4 4 and 5 5 ). After the coarse‐grained averaging, <span class="italic">G</span>  <span class="subscript">ME</span> ( <span class="bold">r</span> , 0 | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">τ</span> ) now becomes a 10° × 10° resolution 2D map defined on a yearly grid for a given <span class="bold">r</span> .</p></div><div class="section"><h2 class="section-title">Computing Prior GFs</h2><span class="label">6.5.3</span><p class="p">We use G G ^ ^ c c simulated in a 1,000‐year control run of the FAMOUS climate model as <span class="italic">G</span>  <span class="subscript">pr</span> for <span class="italic">G</span>  <span class="subscript">MEb</span> .  (27) (27)  G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ = = 1 1 A A p p r r s s G G ^ ^ c c r r , , − − τ τ ∣ ∣ p p r r s s , , 0 0 , , 0 0 ≥ ≥ τ τ ≥ ≥ − − 999 999  years years , , where <span class="italic">p</span> ( <span class="bold">r</span>  <span class="subscript">s</span> ) returns the index of surface patch that <span class="bold">r</span>  <span class="subscript">s</span> is in and <span class="italic">A</span> (⋅) returns the surface area of a patch given its index. FAMOUS is a low resolution version of HadCM3, which uses most of the HadCM3 codes, but runs about 10 times faster (R. S. Smith et al., 2008 2008 ). The FAMOUS G G ^ ^ c c is generated using the same procedure and surface patches as described in Section 4 4 . Because deep oceans ventilate on millennial timescales, <span class="italic">G</span>  <span class="subscript">pr</span> derived from Equation 27 27 does not satisfy Equation 12 12 at every <span class="bold">r</span> . We fill in the rest of <span class="italic">G</span>  <span class="subscript">pr</span> by assuming that the fraction of water ventilated at <span class="italic">τ</span> ≤ −1,000 years is uniformly distributed over a 7,000‐year period and the global ocean surface  (28) (28)  G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ = = 1 1 7 7 , , 000 000 A A o o 1 1 − − ∑ ∑ τ τ = = 0 0 999 999 ∫ ∫ Ω Ω G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ d d 2 2 r r s s , , − − 1 1 , , 000 000 ≥ ≥ τ τ ≥ ≥ − − 7 7 , , 999 999  years years . .  <span class="italic">A</span>  <span class="subscript">0</span> is the surface area of the global ocean A A 0 0 = = ∑ ∑ i i = = 1 1 27 27 A A ( ( i i ) ) . We simply set <span class="italic">G</span>  <span class="subscript">pr</span> to zero for <span class="italic">τ</span> ≤ −8,000 years.</p></div></div></div><div class="section"><h2 class="section-title">Estimating Excess Heat Using Inferred GFs</h2><span class="label">7</span><p class="p">In this section, we examine how well inferred GFs <span class="italic">G</span>  <span class="subscript">ME</span> can reproduce excess heat change in the historical simulation. We derive <span class="italic">G</span>  <span class="subscript">ME</span> by updating a prior estimate of <span class="italic">G</span>  <span class="subscript">c</span> to fit simulated tracer observations (Section 6.2 6.2 ).</p><div class="section"><h2 class="section-title">Error Definitions</h2><span class="label">7.1</span><p class="p">The <span class="italic">G</span>  <span class="subscript">ME</span> estimate of H H e e is inaccurate for the following reasons. First, the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate suffers an “information error,” because observations are insufficient constraints on <span class="italic">G</span>  <span class="subscript">c</span> . Although this problem is regularized by the MaxEnt method, it is likely that <span class="italic">G</span>  <span class="subscript">ME</span> still differs from the true <span class="italic">G</span>  <span class="subscript">c</span> in many aspects. The <span class="italic">G</span>  <span class="subscript">ME</span> estimate also suffers the patch, unforced‐transport and forced‐transport errors like the G G ^ ^ c c estimate discussed in Section 5 5 . We assume that the former two error sources are small for the <span class="italic">G</span>  <span class="subscript">ME</span> estimate because: (a) the <span class="italic">G</span>  <span class="subscript">ME</span> estimate resolves surface BCs at 10° × 10° resolution; and (b) the unforced‐transport error is found small for the G G ^ ^ c c estimate. We partition errors in the <span class="italic">G</span>  <span class="subscript">ME</span> estimate into the information, forced‐transport and BC errors as below, similar to Section 4.4 4.4 .  (29) (29)  i i n n f f o o r r m m a a t t i i o o n n _ _ e e r r r r o o r r = = ∑ ∑ G G M M E E Θ Θ e e s s ∗ ∗ − − Θ Θ e e ∗ ∗   (30) (30)  f f o o r r c c e e d d _ _ t t r r a a n n s s p p o o r r t t _ _ e e r r r r o o r r = = ∑ ∑ G G M M E E Θ Θ e e s s − − Θ Θ e e − − i i n n f f o o r r m m a a t t i i o o n n _ _ e e r r r r o o r r   (31) (31)  B B C C _ _ e e r r r r o o r r = = ∑ ∑ G G M M E E Θ Θ a a s s − − ∑ ∑ G G M M E E Θ Θ e e s s</p><p class="p">We compare the model truth with the <span class="italic">G</span>  <span class="subscript">ME</span> estimates using the same metrics as Section 5 5 . They are: (a) global/basin volume integral (0–2,000 m), (b) zonal‐and‐depth integral (0–2,000 m), and (c) depth distribution of (b) (0–1,500 m). All metrics are showed as anomalies relative to the 1946–1955 average. A change (denoted using “Δ”) is calculated as the difference between 1999–2008 and 1946–1955.</p></div><div class="section"><h2 class="section-title">Evaluating a Baseline Estimate</h2><span class="label">7.2</span><p class="p">In this subsection, we evaluate the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate of H H e e and H H e e ∗ ∗ . This estimate is calculated from Equation 23 23 , wherein we replace <span class="italic">G</span>  <span class="subscript">c</span> with <span class="italic">G</span>  <span class="subscript">MEb</span> . We use <span class="italic">G</span>  <span class="subscript">MEb</span> derived from the historical and control experiments to estimate H H e e and H H e e ∗ ∗ , respectively. H H e e ∗ ∗ is the same as H H e e except that it is evolved by the control ocean transport (see Section 2.4 2.4 ). <span class="italic">G</span>  <span class="subscript">MEb</span> is a particular <span class="italic">G</span>  <span class="subscript">ME</span> constrained by simulated observations in HadCM3 (see Section 6.5 6.5 ). The BCs Θ Θ e e s s and Θ Θ e e s s ∗ ∗ are diagnosed in HadCM3 (i.e., BCs are perfectly known). Note that Section 5 5 uses the same G G ^ ^ c c to estimate H H e e and H H e e ∗ ∗ , which is different from here.</p><div class="section"><h2 class="section-title">Information Error</h2><span class="label">7.2.1</span><p class="p">The <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (blue line) reproduces the global/basin integrated H H e e ∗ ∗ in HadCM3 (black line) well (Figure 11 11 ), with an error of 25% for the global ocean, 27% for the Indo‐Pacific and 38% for the Atlantic. (A percentage error is calculated as the ratio between RMSE and RMSM.) A constant 50 ZJ offset between the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate and the model truth is evident in Figure 11a 11a after 1965 (compare blue and black lines).</p><div class="figure"><div class="figure-label">Figure 11</div><div class="figure-caption">Estimating global/basin integrated (0–2,000 m) excess heat Estimating global/basin integrated (0–2,000 m) excess heat H H e e and H H e e ∗ ∗ in the historical simulation using <span class="italic">G</span>  <span class="subscript">MEb</span> (Section 7.2 7.2 ). Black and gray lines show H H e e ∗ ∗ and H H e e in HadCM3, respectively. Blue and green lines are the <span class="italic">G</span>  <span class="subscript">MEb</span> estimates of H H e e ∗ ∗ and H H e e , respectively. H H e e ∗ ∗ is the same as H H e e except that it is evolved by the control ocean transport. The root‐mean‐square magnitude (RMSM) of the model truth, the root‐mean‐square errors (RMSEs) of the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (first number) and the prior estimate (second number), and the RMS values of the information and forced‐transport errors are listed.</div><div class="graphic"></div></div><p class="p">The <span class="italic">G</span>  <span class="subscript">MEb</span> estimate broadly captures the latitude‐depth pattern of Δ Δ H H e e ∗ ∗ in the Indo‐Pacific and the Atlantic, with a greater error in the latter (Figures 12a–12d 12a–12d compare black and blue lines/contours). The error for depth integrated Δ Δ H H e e ∗ ∗ is 25% and 35% in the Indo‐Pacific and the Atlantic, respectively. In both basins, Δ Δ H H e e ∗ ∗ is underestimated by 0–5 PJ m <span class="superscript">−1</span> at most latitudes, except south of 50°S where it is overestimated (Figures 12a 12a and 12b 12b compare black and blue lines). The overestimate is evident over the 0–1,500 m depths, while the underestimate mostly comes from the 0–400 m depths (Figures 12c 12c and 12d 12d shading). For these zonal integrated metrics, the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate has a similar accuracy compared to the G G ^ ^ c c estimate (Section 5.1 5.1 ) in both basins.</p><div class="figure"><div class="figure-label">Figure 12</div><div class="figure-caption">Estimating latitude distribution of excess heat change Estimating latitude distribution of excess heat change Δ Δ H H e e and Δ Δ H H e e ∗ ∗ in the historical simulation using <span class="italic">G</span>  <span class="subscript">MEb</span> (Section 7.2 7.2 ). (a and b) Zonal‐and‐depth integral (0–2,000 m). (c–f) Depth distribution of panels (a and b). In all panels, black and gray lines show H H e e ∗ ∗ and H H e e in HadCM3, respectively; blue and green lines show the <span class="italic">G</span>  <span class="subscript">MEb</span> estimates of H H e e ∗ ∗ and H H e e , respectively. Shading in panels (c and d) indicates errors in the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate of H H e e ∗ ∗ (the information error). Shading in panels (e and f) indicates errors in the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate of H H e e minus the information error (the forced‐transport error). For each metric, the root‐mean‐square magnitude (RMSM) of the model truth, the root‐mean‐square errors (RMSEs) of the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (first number) and the prior estimate (second number), and the RMS values of the information and forced‐transport errors are listed. All changes are calculated as differences between 1999–2008 and 1946–1955.</div><div class="graphic"></div></div></div><div class="section"><h2 class="section-title">Forced‐Transport Error</h2><span class="label">7.2.2</span><p class="p">The forced‐transport error causes an overestimate in the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate, especially at northern mid latitudes (Figures 12e 12e and 12f 12f , shading), similar to that in the G G ^ ^ c c estimate. The forced‐transport error is more than twice as large as the information error for the global and the Atlantic integrated H H e e (Figure 11 11 ), while it is about the same size as the information error for zonal integrated Δ Δ H H e e (Figure 12 12 ). In the Atlantic, the underestimate caused by the information error is partially compensated by the overestimate caused by the forced‐transport error, reducing the total error there (except south of 50°S) (Figure 12b 12b ).</p></div><div class="section"><h2 class="section-title">Effects of Data Constraints</h2><span class="label">7.2.3</span><p class="p">How do data constraints improve on the initial guess <span class="italic">G</span>  <span class="subscript">pr</span> ? We examine this question by comparing RMSEs between the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate and the <span class="italic">G</span>  <span class="subscript">pr</span> estimate. The <span class="italic">G</span>  <span class="subscript">pr</span> estimate is calculated using the same equation as the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate, except replacing <span class="italic">G</span>  <span class="subscript">MEb</span> with <span class="italic">G</span>  <span class="subscript">pr</span> . The <span class="italic">G</span>  <span class="subscript">MEb</span> estimate has a smaller RMSE compared to the <span class="italic">G</span>  <span class="subscript">pr</span> estimate for all the metrics examined in Figures 11 11 and 12 12 (shown by numbers in the legends). The reduction of RMSE is between 20% and 40% (the number is different for different metrics). The exceptions are the global and the Atlantic integrated H H e e , for which the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate has a greater RMSE than the <span class="italic">G</span>  <span class="subscript">pr</span> estimate (Figure 11c 11c ). We suspect that this increase of RMSE is related to the forced‐transport error, because the same behavior is not found for H H e e ∗ ∗ .</p></div></div><div class="section"><h2 class="section-title">GF Estimate in a Real‐World Application</h2><span class="label">7.3</span><p class="p">In this subsection, we simulate a real‐world application of the GF method in the model world. Specifically, we estimate excess heat H H e e in the historical simulation using: (a) simulated Θ Θ a a s s and (b) <span class="italic">G</span>  <span class="subscript">MEb</span> derived from simulated observations. This calculation can be repeated using the real‐world Θ Θ a a s s and observations. To distinguish the Θ Θ e e s s ‐based <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (examined in Sections 7.2 7.2 ) from the Θ Θ a a s s ‐based <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (to be examined below), we refer to the latter as the G G M M E E b b + + estimate. The G G M M E E b b + + estimate suffers an additional BC error compared to the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate, because of the differences between Θ Θ a a s s and Θ Θ e e s s . The BC error of the G G M M E E b b + + estimate is similar to that of the G G ^ ^ c c + + estimate in Section 5.3 5.3 (compare Figures 9 9 and 13 13 ). In particular, the BC error is at least as large as the information and forced‐transport errors for all metrics examined in Figure 13 13 .</p><div class="figure"><div class="figure-label">Figure 13</div><div class="figure-caption">Estimating excess heat Estimating excess heat H H e e in the historical simulation using <span class="italic">G</span>  <span class="subscript">MEb</span> and Θ Θ a a s s (Section 7.3 7.3 ). This estimate is referred to as the G G M M E E b b + + estimate. (a and b) Basin‐volume integral. (c and d) Zonal‐and‐depth integrated change (0–2,000 m). (e and f) Depth distribution of panels (c and d). In all panels, black lines are the model truth, orange lines are the G G M M E E b b + + estimate, and green lines are the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate in Figures 11 11 and 12 12 . Shading in panels (e–f) indicates the boundary condition (BC) error (Equation 31 31 ). For each metric, the root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square errors (RMSEs) of the two Green's function estimates are listed, along with the RMS values of the information, forced‐change and BC errors.</div><div class="graphic"></div></div><p class="p">When all errors are considered, the G G M M E E b b + + estimate reconstructs the model truth with an error of 50% for basin integrated H H e e and 40% for zonal‐and‐depth integrated Δ Δ H H e e (Figures 13a–13d 13a–13d , RMSEs of orange lines). In the Indo‐Pacific the error is largest around 40°S, while in the Atlantic the error is of similar magnitude across latitudes (Figures 13c 13c and 13d 13d , compare black and orange lines). It is important to note that the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate is more accurate than the G G M M E E b b + + estimate for all metrics examined here. This highlights the need to reduce the BC error when applying inferred GFs to estimate the real‐world excess heat.</p></div><div class="section"><h2 class="section-title">Sensitivity of the <span class="italic">G</span>  <span class="subscript">MEb</span> Estimate</h2><span class="label">7.4</span><p class="p">In this subsection, we examine how sensitive the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate is to the choice of data constraints and priors. For each sensitivity experiment, we focus on two metrics: (a) basin integral and (b) zonal‐and‐depth integrated change. Both metrics are calculated for H H e e only and integrated over the 0–2,000 m layers.</p><div class="section"><h2 class="section-title">Constraints From SF <span class="subscript">6</span> and Bomb Δ <span class="superscript">14</span> C</h2><span class="label">7.4.1</span><p class="p">In the first experiment, we add SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C at year 1994 as additional constraints, while keeping other settings unchanged. Adding SF <span class="subscript">6</span> alone or SF <span class="subscript">6</span> and Δ <span class="superscript">14</span> C together has little impact on the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (not shown). For instance, the RMSE change due to SF <span class="subscript">6</span> is less than 2% for all the metrics.</p><p class="p">How much can SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C improve on the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate if it has little prior knowledge of ocean transports? We examine this question by replacing the FAMOUS prior in <span class="italic">G</span>  <span class="subscript">MEb</span> with a uniform prior; the resulting <span class="italic">G</span>  <span class="subscript">ME</span> is referred to as <span class="italic">G</span>  <span class="subscript">MEu</span> . The uniform prior is defined as  (32) (32)  G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ = = 1 1 8 8 , , 000 000 A A 0 0 , , 0 0 ≥ ≥ τ τ > > − − 8 8 , , 000 000  years years , , G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ = = 0 0 , , τ τ ≤ ≤ − − 8 8 , , 000 000  years years , , where <span class="italic">A</span>  <span class="subscript">0</span> is the surface area of the global ocean. The uniform prior assumes that a water parcel, regardless of its interior location, contains equal amounts of water from all surface locations and times over the previous 8,000 years. When the uniform prior is used, we relax the regularization parameter <span class="italic">λ</span> (see Section 6.2 6.2 ) from unity to 0.1 so that more modification to the prior is allowed compared to when the FAMOUS prior is used.</p><p class="p">The <span class="italic">G</span>  <span class="subscript">MEu</span> estimate of H H e e (red line) is about 50% lower than the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (gray line) in both the Indo‐Pacific and the Atlantic (Figure 14 14 ). The <span class="italic">G</span>  <span class="subscript">MEu</span> estimate is improved by adding bomb Δ <span class="superscript">14</span> C (green line) as a constraint, but not by adding SF <span class="subscript">6</span> (blue line) (Figure 14 14 ). This is because bomb Δ <span class="superscript">14</span> C and CFCs have very different surface BCs (Figures 10b 10b and 10e 10e ), which provides additional constraints (equations) to the inverse problem. In contrast, the surface BCs are very similar between SF <span class="subscript">6</span> and CFCs. The improvement due to bomb Δ <span class="superscript">14</span> C is much greater in the Indo‐Pacific than in the Atlantic. This is probably because the surface BCs of Θ <span class="subscript">e</span> and bomb Δ <span class="superscript">14</span> C are more alike in the Indo‐Pacific than Atlantic (compare Figures 10e 10e and 5d 5d ). In particular, the pattern of surface Θ <span class="subscript">e</span> peaks in the North Atlantic, whereas the pattern of surface bomb Δ <span class="superscript">14</span> C is at its minimum in that region.</p><div class="figure"><div class="figure-label">Figure 14</div><div class="figure-caption">Sensitivity of the Sensitivity of the <span class="italic">G</span>  <span class="subscript">MEu</span> estimate to additional constraints from SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C. (a and b) Basin integrated H H e e . (c and d) Zonal‐and‐depth integrated Δ Δ H H e e . The model truth is shown in black lines. The <span class="italic">G</span>  <span class="subscript">MEu</span> estimates constrained by different tracers are color coded. For comparison, the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate is included as gray lines. The root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square errors (RMSEs) of different estimates are listed.</div><div class="graphic"></div></div></div><div class="section"><h2 class="section-title">Perturbing Prior GFs</h2><span class="label">7.4.2</span><p class="p">In the second experiment, we replace the FAMOUS prior in the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate with Inverse Gaussian (IG) distributions of different shape, following Holzer et al. ( 2018 2018 ). The IG distribution is the analytical form of <span class="italic">G</span>  <span class="subscript">c</span> for constant 1D flow; a narrower IG distribution implies that the flow has a higher Peclet number (Waugh & Hall, 2002 2002 ). The method of constructing the IG prior is described in Appendix E E . The three IG priors tested here are called IG‐0.5, IG‐1.0, and IG‐1.5.</p><p class="p">Replacing the FAMOUS prior with the IG priors leads to a change in RMSE of less than 20% for all metrics examined in Figure 15 15 . Among the three IG priors, IG‐1.0 (corresponds to a Peclet number of one) gives the closest estimate compared to the FAMOUS prior. The RMSE of the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate (first column) is always reduced compared to that of the <span class="italic">G</span>  <span class="subscript">pr</span> estimate (second column) regardless of which prior is used (Figure 15 15 numbers in the legends), except for the Atlantic integral. This highlights the constraints of CFCs and climatological temperature and salinity on the passage of excess heat in the ocean.</p><div class="figure"><div class="figure-label">Figure 15</div><div class="figure-caption">Sensitivity of the Sensitivity of the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate to the choice of prior ( <span class="italic">G</span>  <span class="subscript">pr</span> ). (a and b) Basin integrated H H e e . (c and d) Zonal‐and‐depth integrated Δ Δ H H e e . The model truth is shown in black lines. The <span class="italic">G</span>  <span class="subscript">MEb</span> estimates with different <span class="italic">G</span>  <span class="subscript">pr</span> are color coded. For each <span class="italic">G</span>  <span class="subscript">pr</span> , the RMSEs of the <span class="italic">G</span>  <span class="subscript">MEb</span> and <span class="italic">G</span>  <span class="subscript">pr</span> estimates are listed from left to right. IG‐0.5, IG‐1.0, and IG‐1.5 are approximations of the FAMOUS prior using Inverse Gaussian forms of different shape.</div><div class="graphic"></div></div></div><div class="section"><h2 class="section-title">Perturbing Time of Constraints</h2><span class="label">7.4.3</span><p class="p">In the third experiment, we alter the year of data constraints in the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate from 1994 to 1984, 1989, 1999, and 2004, while keeping other settings unchanged. The resulting change in RMSE is about 2% in the Indo‐Pacific and 5% in the Atlantic (Figure 16 16 RMSEs in the legends).</p><div class="figure"><div class="figure-label">Figure 16</div><div class="figure-caption">Sensitivity of the Sensitivity of the <span class="italic">G</span>  <span class="subscript">MEb</span> estimate to the time of data constraints. (a and b) Basin integrated H H e e . (c and d) Zonal‐and‐depth integrated Δ Δ H H e e . The model truth is shown in black lines. The <span class="italic">G</span>  <span class="subscript">MEb</span> estimates with different data years are color coded. The prior estimate is shown in gray lines. The root‐mean‐square magnitude (RMSM) of the model truth and the root‐mean‐square errors (RMSEs) of different estimates are listed.</div><div class="graphic"></div></div></div></div></div><div class="section"><h2 class="section-title">Summary</h2><span class="label">8</span><div class="section"><h2 class="section-title">Excess Heat and Green's Functions</h2><span class="label">8.1</span><p class="p">The ocean stores over 93% of the “excess heat” that has entered the climate system in recent decades (Meyssignac et al., 2019 2019 ). This excess heat is added to the ocean surface by air‐sea fluxes (warming or cooling) and carried to depths by ocean transports. One method to estimate excess heat is to propagate its surface BCs downward using a GF representation of ocean transports. The GFs can be derived from: (a) simulating idealized tracers in a model (“simulated GFs”) or (b) solving an inverse problem using tracer observations (“inferred GFs”) (Holzer et al., 2010 2010 ; Khatiwala et al., 2009 2009 ; Zanna et al., 2019 2019 ). The BCs are often derived from SST anomaly in the literature.</p></div><div class="section"><h2 class="section-title">Errors in the GF Method</h2><span class="label">8.2</span><p class="p">The GF estimate of excess heat is inaccurate for the following reasons. Patch error: Simulated GFs are coarse grained in space and time, hence they partially neglect the covariance between the true GFs and surface BCs. Patch error: Simulated GFs are coarse grained in space and time, hence they partially neglect the covariance between the true GFs and surface BCs. Transport error: Simulated/inferred GFs do not resolve time‐varying ocean transports due to unforced variability and forced change. Transport error: Simulated/inferred GFs do not resolve time‐varying ocean transports due to unforced variability and forced change. Information error: Observations are insufficient constraints for inferring GFs. Information error: Observations are insufficient constraints for inferring GFs. BC error: SST anomalies are contaminated by redistributed changes. BC error: SST anomalies are contaminated by redistributed changes. Model error: Modeled ocean transports encoded in simulated GFs are different from those of the real world. Model error: Modeled ocean transports encoded in simulated GFs are different from those of the real world.</p></div><div class="section"><h2 class="section-title">HadCM3 Perfect‐Model Test</h2><span class="label">8.3</span><p class="p">How different errors affect the accuracy of the GF method has not been examined in the literature. Here, we investigate this question using a historical simulation (1860–2008) conducted in the HadCM3 AOGCM. We treat this simulation as the real world, and compare excess heat H H e e diagnosed in it (as the “truth”) with that estimated using simulated/inferred GFs. Details on how different errors are computed are given in Sections 4.4 4.4 and 7.1 7.1 . We focus on evaluating H H e e derived from GFs instead of GFs themselves, because not every detail in GFs matters for estimating H H e e .</p></div><div class="section"><h2 class="section-title">Estimating Excess Heat Using Simulated GFs</h2><span class="label">8.4</span><span class="p">We generate simulated GFs in a 200‐year pre‐industrial control experiment of HadCM3.</span><div class="section"><h2 class="section-title">How Accurate Is the Method?</h2><span class="label">8.4.1</span><p class="p">The simulated GFs reconstruct H H e e in the Indo‐Pacific with a RMS error of 48% for the volume integral and 26% for zonal‐and‐depth integrated changes; the corresponding numbers are 39% and 37% in the Atlantic, respectively (including all errors except the model error). The volume integral is most affected by the forced‐transport and BC errors; the patch error is <1/3 of the BC error in terms of the RMS value. The zonal‐and‐depth integral is affected by the patch, forced‐transport and BC errors to a similar degree; the BC error is slightly larger than the other two in the Indo‐Pacific. The unforced‐transport error is <1/3 of the patch error for all metrics examined here. Results of this subsection are summarized in Figure 9 9 .</p></div><div class="section"><h2 class="section-title">Underestimated or Overestimated?</h2><span class="label">8.4.2</span><p class="p">The patch error causes an underestimate of H H e e in the North Atlantic, and an overestimate of H H e e south of 40°S. The forced‐transport error causes an overestimate of H H e e at most latitudes, especially in the northern subtropics. The BC error causes an underestimate of H H e e in the Southern Ocean. This underestimate partially cancels out the patch and forced‐transport errors, reducing the total error in the Southern Ocean. Note that the degree to which this error compensation would work may be different in the real world and in other models.</p></div></div><div class="section"><h2 class="section-title">Estimating Excess Heat Using Inferred GFs</h2><span class="label">8.5</span><p class="p">We compute inferred GFs by using HadCM3 equivalents of the GLODAPv1 data as constraints to update a prior estimate of GFs. The GLODAPv1 data consist of CFC‐11 and CFC‐12 at year 1994 and climatological temperature and salinity (Key et al., 2004 2004 ).</p><div class="section"><h2 class="section-title">How Accurate Is the Method?</h2><span class="label">8.5.1</span><p class="p">The inferred GFs reconstruct H H e e in the Indo‐Pacific with an error of 50% for the volume integral and 34% for zonal‐and‐depth integrated changes; the corresponding numbers are 44% and 42% in the Atlantic, respectively (including all errors). The volume integral is most affected by the BC error; the information and forced‐transport errors are about 2/3 of the BC error (in terms of the RMS value) in the Indo‐Pacific. The zonal‐and‐depth integral is affected by the information, forced‐transport and BC errors to a similar degree; although the BC error is slightly larger than the other two in the Indo‐Pacific. Results of this subsection are summarized in Figure 13 13 .</p></div><div class="section"><h2 class="section-title">Underestimated or Overestimated?</h2><span class="label">8.5.2</span><p class="p">The information error causes an underestimate of H H e e at most latitudes (except south of 50°S). The forced‐transport and BC errors have the same effects as discussed with simulated GFs. In the Atlantic, the information error partially compensates the forced‐transport error, reducing the total error there. It is unclear whether the same compensation would occur in the real world or in other models. Removing the BC error improves the estimate with inferred GFs significantly.</p></div><div class="section"><h2 class="section-title">Sensitivity to Data Constraints and Priors</h2><span class="label">8.5.3</span><p class="p">The estimate of H H e e from inferred GFs is not sensitive to: (a) shifting the data year by ±10, (b) small changes in the shape of prior GFs, or (c) adding 1994 SF <span class="subscript">6</span> and bomb <span class="superscript">14</span> C as additional constraints, although bomb <span class="superscript">14</span> C (but not SF <span class="subscript">6</span> ) helps when a less informative prior is used.</p></div></div></div><div class="section"><h2 class="section-title">Discussions</h2><span class="label">9</span><div class="section"><h2 class="section-title">Model Error of Simulated GFs</h2><span class="label">9.1</span><p class="p">Because we use GFs simulated in HadCM3 to estimate excess heat H H e e in the HadCM3 world, our results do not include the model error. To explore this error, one could perturb simulated GFs to generate an ensemble of estimates (Zanna et al., 2019 2019 ). An alternative would be to use more than one AOGCM; by treating one of them as though it were perfect, one could make an estimate with the GFs of another. This approach would not include the effect of errors common to all models.</p></div><div class="section"><h2 class="section-title">Is Air‐Sea Flux GF a Better Option?</h2><span class="label">9.2</span><p class="p">As well as concentration BCs, one can propagate surface heat fluxes to estimate H H e e using simulated GFs (with a different configuration). In HadCM3, we find that this method gives a better estimate of H H e e than propagating concentration BCs. However, observations of surface heat flux are not adequate for the purpose of estimating H H e e . For example, the Objectively Analyzed air‐sea Fluxes (Yu et al., 2008 2008 ) are not available before 1985 and do not have the accuracy to resolve the global mean energy imbalance.</p></div><div class="section"><h2 class="section-title">Simulated GFs Versus Ocean Model</h2><span class="label">9.3</span><span class="p">Evolution of passive tracers in the model world can be studied using simulated GFs as well as ocean models. Ocean models are more accurate than simulated GFs for this regard, because they do not suffer the patch and transport errors. In addition, GFs are computationally expensive to derive.</span><p class="p">Nonetheless, simulated GFs are useful for the following purposes. First, simulated GFs encapsulate the effect of a model's ocean transports in a form that can be easily shared within the community. Especially, GFs are much easier to use than 3D ocean models. Second, simulated GFs can be used to quantify the surface sources and timescales of a tracer response (e.g., Marzocchi et al., 2021 2021 ; Wu et al., 2021 2021 ; Zanna et al., 2019 2019 ).</p></div><div class="section"><h2 class="section-title">Improving Simulated GFs</h2><span class="label">9.4</span><p class="p">Simulating GFs with finer surface patches can reduce the patch error. At the limit that every grid box is a patch, the patch error is completely eliminated. What is the best strategy to simulate GFs given a limited amount of computer time? Air‐sea fluxes and surface concentrations of a tracer often exhibit low‐dimensional structures in space. Designing patches around these structures can reduce the patch error at low computational cost (see Appendix F F for two examples). On the time dimension, simulating GFs starting from various years in a historical simulation (e.g., Marzocchi et al., 2021 2021 ) can reduce the unforced‐ and forced‐transport errors. For instance, a set of GFs per year can capture time variation of ocean transports on interannual and longer timescales. Simulating GFs starting from every 10 years of the historical run would be less accurate, but more appealing computationally. Sensitivity tests to find the optimal time interval for time‐dependent GFs would be useful.</p></div><div class="section"><h2 class="section-title">Improving Inferred GFs</h2><span class="label">9.5</span><p class="p">To reduce the information error, one could add observations in the GLODAPv2 data set (Olsen et al., 2016 2016 ) as additional constraints. At present, CFCs only constrain GFs at multi‐decadal and shorter lead times, limited by their surface histories. It is important to maintain observations of transient tracers in the ocean, so that new observations can be added to constrain GFs over longer lead times in the future.</p></div><div class="section"><h2 class="section-title">Excess Temperature BCs</h2><span class="label">9.6</span><p class="p">To derive excess temperature BCs, one could combine modeled patterns of surface excess temperature and observed global‐mean SST anomalies to form hybrid excess temperature BCs. These new BCs may help reduce the contamination of redistributive cooling in the SST BCs (e.g., Figure 5 5 ). Note that there are uncertainties in the modeled patterns of excess temperature because of the spread in the modeled surface heat fluxes (e.g., in the CMIP6 ensemble).</p></div></div><div class="section"><h2 class="section-title">Notation</h2><div class="def-list"><span class="title">Notation</span><div class="def-item"><div class="term"><span class="bold">r</span></div><div class="def"><span class="p">3D position vector of the ocean</span></div></div><div class="def-item"><div class="term"><span class="bold">r</span><span class="sub">s</span></div><div class="def"><span class="p">2D position vector of the ocean surface</span></div></div><div class="def-item"><div class="term"><span class="italic">t</span></div><div class="def"><span class="p">time variable in general</span></div></div><div class="def-item"><div class="term"><span class="italic">t</span><span class="sub">s</span></div><div class="def"><span class="p">time variable of surface source</span></div></div><div class="def-item"><div class="term"><span class="italic">Q</span><span class="sub">ctrl</span></div><div class="def"><span class="p">Net surface heat fluxes in the pre‐industrial control experiment</span></div></div><div class="def-item"><div class="term"><span class="italic">Q</span><span class="sub">ERF</span></div><div class="def"><span class="p">Effective radiative forcing of the historical experiment</span></div></div><div class="def-item"><div class="term"><span class="italic">Q</span>′</div><div class="def"><span class="p">Changes in surface heat fluxes due to climate feedbacks</span></div></div><div class="def-item"><div class="term">Θ<span class="sub">ctrl</span></div><div class="def"><span class="p">Ocean potential temperature in the pre‐industrial control experiment</span></div></div><div class="def-item"><div class="term">Θ<span class="sub">hist</span></div><div class="def"><span class="p">Ocean potential temperature in the historical experiment</span></div></div><div class="def-item"><span class="term">Φ</span><div class="def"><span class="p">3D ocean transport operator in general</span></div></div><div class="def-item"><div class="term"><span class="italic">L</span><span class="sub">ctrl</span>,Φ</div><div class="def"><span class="p">saved from the pre‐industrial control experiment</span></div></div><div class="def-item"><div class="term"><span class="italic">L</span><span class="sub">hist</span>,Φ</div><div class="def"><span class="p">saved from the historical experiment</span></div></div><div class="def-item"><div class="term">Θ<span class="sub">a</span></div><div class="def"><p class="p">Historical ocean temperature anomaly, Θ <span class="subscript">a</span> = Θ <span class="subscript">hist</span> − Θ <span class="subscript">hist</span></p></div></div><div class="def-item"><div class="term">Θ<span class="sub">e</span></div><div class="def"><p class="p">Excess temperature tracer evolved by <span class="italic">L</span>  <span class="subscript">hist</span></p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msubsup"><span class="mi">Θ</span><span class="mi">e</span><span class="mo">∗</span></div></div></div></div></div><div class="def"><p class="p">Excess temperature tracer evolved by <span class="italic">L</span>  <span class="subscript">ctrl</span></p></div></div><div class="def-item"><div class="term">Θ<span class="sub">r</span></div><div class="def"><p class="p">Redistributed temperature tracer, Θ <span class="subscript">a</span> = Θ <span class="subscript">e</span> + Θ <span class="subscript">r</span></p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msub"><div class="mrow"><span class="mi">H</span></div><span class="mi">a</span></div></div></div></div></div><div class="def"><p class="p">Historical ocean heat content anomaly, extensive form of Θ <span class="subscript">a</span></p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msub"><div class="mrow"><span class="mi">H</span></div><span class="mi">e</span></div></div></div></div></div><div class="def"><p class="p">Excess heat content evolved by <span class="italic">L</span>  <span class="subscript">hist</span> , extensive form of Θ <span class="subscript">e</span></p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msubsup"><div class="mrow"><span class="mi">H</span></div><span class="mi">e</span><span class="mo">∗</span></div></div></div></div></div><div class="def"><p class="p">Excess heat content evolved by <span class="italic">L</span>  <span class="subscript">ctrl</span> , extensive form of Θ Θ e e ∗ ∗</p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msub"><div class="mrow"><span class="mi">H</span></div><span class="mi">r</span></div></div></div></div></div><div class="def"><p class="p">Redistributed heat content, extensive form of Θ <span class="subscript">r</span></p></div></div><div class="def-item"><div class="term"><span class="italic">X</span></div><div class="def"><p class="p">Concentration of a tracer, <span class="italic">X</span> could be Θ <span class="subscript">a</span> , Θ <span class="subscript">e</span> , Θ Θ e e ∗ ∗ , etc.</p></div></div><div class="def-item"><div class="term"><span class="italic">X</span><span class="sup">s</span></div><div class="def"><p class="p"><span class="italic">X</span> at the surface</p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msup"><div class="mover"><span class="mi">X</span><span class="mo">^</span></div><span class="mi">s</span></div></div></div></div></div><div class="def"><p class="p"><span class="italic">X</span>  <span class="superscript">s</span> averaged onto a yearly grid and surface patches</p></div></div><div class="def-item"><div class="term"><span class="italic">G</span></div><div class="def"><span class="p">Boundary GF of tracer transport equation in general</span></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">c</span></div><div class="def"><p class="p"><span class="italic">G</span> defined for surface concentration BCs</p></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">f</span></div><div class="def"><p class="p"><span class="italic">G</span> defined for air‐sea tracer fluxes or surface sources/sinks</p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msub"><div class="mover"><span class="mi">G</span><span class="mo">^</span></div><span class="mi">c</span></div></div></div></div></div><div class="def"><p class="p">Simulated <span class="italic">G</span>  <span class="subscript">c</span> defined for yearly‐ and patch‐averaged surface conditions</p></div></div><div class="def-item"><div class="term"><div class="math"><div class="mrow"><div class="mrow"><div class="msub"><div class="mover"><span class="mi">G</span><span class="mo">^</span></div><span class="mi">f</span></div></div></div></div></div><div class="def"><p class="p">Simulated <span class="italic">G</span>  <span class="subscript">f</span> defined for yearly‐ and patch‐averaged surface sources/sinks</p></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">ME</span></div><div class="def"><p class="p">Maximum entropy estimate of <span class="italic">G</span>  <span class="subscript">c</span> in general</p></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">pr</span></div><div class="def"><p class="p">Prior estimate of <span class="italic">G</span>  <span class="subscript">c</span> used in <span class="italic">G</span>  <span class="subscript">ME</span></p></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">MEb</span></div><div class="def"><p class="p"><span class="italic">G</span>  <span class="subscript">ME</span> constrained by GLODAPv1 data and the FAMOUS prior</p></div></div><div class="def-item"><div class="term"><span class="italic">G</span><span class="sub">MEu</span>,<span class="italic">G</span><span class="sub">ME</span></div><div class="def"><span class="p">constrained by GLODAPv1 data and the uniform prior</span></div></div></div></div><div class="section"><h2 class="section-title">Acronyms</h2><div class="def-list"><span class="title">Acronyms</span><div class="def-item"><span class="term">GF</span><div class="def"><span class="p">Green's function</span></div></div><div class="def-item"><span class="term">BC</span><div class="def"><span class="p">boundary condition</span></div></div><div class="def-item"><span class="term">MaxEnt</span><div class="def"><span class="p">maximum entropy</span></div></div><div class="def-item"><span class="term">IG</span><div class="def"><span class="p">Inverse Gaussian</span></div></div><div class="def-item"><span class="term">RMSE</span><div class="def"><span class="p">root‐mean‐square error</span></div></div><div class="def-item"><span class="term">RMSM</span><div class="def"><span class="p">root‐mean‐square magnitude</span></div></div></div></div></div><div class="back"><div class="ack"><span class="title">Acknowledgments</span><span class="p">The authors are grateful to Samar Khatiwala for discussions of the maximum entropy method and the suggestion about testing anthropogenic radiocarbon, to Thorsten Mauritsen for providing the ECHAM6.3 surface forcing data set, and to Elaine McDonagh, Laure Zanna, Heather Graven, and other colleagues at TICTOC meetings for useful discussions. This project has received funding from the UK Natural Environment Research Council (NERC) Grant NE/P019099/1 for the TICTOC project and the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation program (Grant Agreement No. 786427, project “Couplet”). The authors thank Tom Haine and two anonymous reviewers for their careful evaluation of the manuscript. Their comments and suggestions help to improve the manuscript significantly. The authors acknowledge the World Climate Research Program's Working Group on Coupled Modelling, which is responsible for CMIP, for producing and making available their model output.</span></div><div class="section"><h2 class="section-title">Data Availability Statement</h2><p class="p">Outputs from the historical simulation are published at <a href="https://doi.org/10.5281/zenodo.6790458" target="_blank" class="link">https://doi.org/10.5281/zenodo.6790458</a> . Simulated tracer Green's functions are published at <a href="https://doi.org/10.5281/zenodo.6792335" target="_blank" class="link">https://doi.org/10.5281/zenodo.6792335</a> . The CESM2 data are available at <a href="https://esgf-node.llnl.gov" target="_blank" class="link">https://esgf-node.llnl.gov</a> . For the use of the HadCM3 model, contact <a href="mailto:UM_collaboration@metoffice.gov.uk" target="_blank" class="link">UM_collaboration@metoffice.gov.uk</a> .</p></div><div class="references"><h2>References</h2></div><div class="app-group"><div class="app"><span class="label">Appendix A</span><span class="title">Forcing the Historical Simulation</span><p class="p">We did not conduct the historical simulation by prescribing CO <span class="subscript">2</span> and other forcing agents in the atmosphere. This is because HadCM3 does not include an up‐to‐date treatment of anthropogenic aerosol forcing, especially aerosol‐cloud interaction. (In the historical experiments of Stott et al. ( 2000 2000 ), the effect of tropospheric aerosol on cloud reflectivity was approximately represented by prescribed perturbations to surface albedo.) In addition, since our focus is on heat uptake, it is convenient to prescribe the heat flux which is added to the ocean. The use of surface forcing omits any non‐radiative effects of forcing agents and their radiative effects directly in the atmosphere. But those effects are relatively minor and not important in this work. As shown in Section 2.3 2.3 , the historical simulation is sufficiently close to observations for the purposes of this study.</p></div><div class="app"><span class="label">Appendix B</span><h1 class="title">Passive and Dynamical Θ <span class="subscript">e</span> Definitions</h1><p class="p">In Section 2 2 , we define excess temperature Θ <span class="subscript">e</span> as a passive tracer evolved by the pre‐computed transport operator <span class="italic">L</span>  <span class="subscript">hist</span> (Equation 6 6 ). Alternatively, we can define Θ <span class="subscript">e</span> as a dynamical tracer that affects ocean transports.  (B1) (B1)  ∂ ∂ Θ Θ e e ∂ ∂ t t + + Φ Φ Θ Θ e e = = 1 1 ρ ρ 0 0 c c p p d d z z 1 1 Q Q ERF ERF + + Q Q ′ ′ , , initial condition: initial condition: Θ Θ e e ( ( 0 0 ) ) = = 0 0 . . Φ is the ocean transport operator in general (Equation 2 2 ). Φ(Θ <span class="subscript">e</span> ) is a nonlinear function of Θ <span class="subscript">e</span> because Θ <span class="subscript">e</span> affects Θ which affects Φ. Integrating Equation B1 B1 in the historical simulation gives the same evolution of Θ <span class="subscript">e</span> as that derived from Equation 6 6 . The two definitions, however, correspond to different constructions of GFs.</p><p class="p">The GFs of Equation 6 6 are “passive” GFs; they are evolved by the same <span class="italic">L</span>  <span class="subscript">hist</span> operator (see Equation 14 14 ) regardless of the time and location of the Θ <span class="subscript">e</span> perturbation, because <span class="italic">L</span>  <span class="subscript">hist</span> is a pre‐computed quantity. To simulate GFs for Equation 6 6 one only needs pre‐computed velocities and diffusivities in principle. In contrast, the GFs of Equation B1 B1 are “dynamical” GFs; they are evolved by different Φ operators, because Φ depends on the location and time of the Θ <span class="subscript">e</span> perturbation. To simulate GFs for Equation B1 B1 one needs a full ocean model to interactively compute Φ for every Θ <span class="subscript">e</span> perturbation.</p><p class="p">Because Φ depends on the forcing, the solution of Equation B1 B1 cannot be written as a superposition of impulse responses scaled with the forcing. That is, the GF estimate of the dynamical Θ <span class="subscript">e</span> has a nonlinear error. The GF estimate of the passive Θ <span class="subscript">e</span> , however, does not have a nonlinear error, because <span class="italic">L</span>  <span class="subscript">hist</span> is independent of the forcing (i.e., Equation 6 6 is strictly linear). The unforced‐ and forced‐transport errors (Section 4.1 4.1 ) arise because we neglect the time‐evolution of GFs to reduce computational time, not because the GF method is inherently inaccurate.</p></div><div class="app"><span class="label">Appendix C</span><span class="title">Maximum Entropy Method</span><div class="section"><h2 class="section-title">Problem Formulation</h2><span class="label">C1</span><p class="p">Inferring <span class="italic">G</span>  <span class="subscript">c</span> ( <span class="bold">r</span> , 0 | <span class="bold">r</span>  <span class="subscript">s</span> , <span class="italic">τ</span> ) from <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> ( <span class="bold">r</span> , <span class="italic">t</span>  <span class="subscript"><span class="italic">n</span></span> ) and X X n n s s r r s s , , t t s s is an underdetermined problem. Among infinitely many estimates of <span class="italic">G</span>  <span class="subscript">c</span> that satisfy Equation 23 23 , we choose one based on the principle of Minimum Discrimination Information (MDI) (Kullback, 1959 1959 ). Recall that <span class="italic">G</span>  <span class="subscript">c</span> is like a Probability Distribution Function (PDF) (Section 3 3 ). The principle of MDI states that: to update a prior PDF using new facts (i.e., constraints), the new PDF should be chosen such that it is the “nearest” to the prior PDF. The distance between two PDFs is measured using relative entropy in MDI.</p><p class="p">Applying the principle of MDI, we determine the best estimate of <span class="italic">G</span>  <span class="subscript">c</span> by solving the following constrained optimization problem. The Lagrangian function of the problem is given as  (C1) (C1)  L L G G , , a a 1 1 , , ⋯ ⋯ , , a a N N = = D D KL KL G G ∣ ∣ G G p p r r + + ∑ ∑ n n = = 1 1 N N a a n n X X n n r r , , t t n n − − X X n n ′ ′ r r , , t t n n . .  <span class="italic">G</span> is an unknown PDF. <span class="italic">G</span>  <span class="subscript">pr</span> is a prior PDF. <span class="italic">D</span>  <span class="subscript">KL</span> ( <span class="italic">G</span> | <span class="italic">G</span>  <span class="subscript">pr</span> ) is the Kullback‐Leibler divergence, or the relative entropy, between <span class="italic">G</span> and <span class="italic">G</span>  <span class="subscript">pr</span>   (C2) (C2)  D D KL KL G G ∣ ∣ G G p p r r = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ 0 0 G G r r , , 0 0 ∣ ∣ r r s s , , τ τ log log G G r r , , 0 0 ∣ ∣ r r s s , , τ τ G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ d d τ τ . .  <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> is the Lagrange multiplier. <span class="italic">N</span> is the total number of constraints. Each constraint takes the form X X n n = = X X n n ′ ′ . X X n n ′ ′ is an estimate of <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> using <span class="italic">G</span> , calculated by substituting <span class="italic">G</span> into Equation 23 23 .  (C3) (C3)  X X n n ′ ′ r r , , t t n n = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ t t n n G G r r , , 0 0 ∣ ∣ r r s s , , t t s s − − t t n n X X n n s s r r s s , , t t s s d d t t s s . .</p></div><div class="section"><h2 class="section-title">Exact Solution</h2><span class="label">C2</span><p class="p">The optimization problem is solved by setting ∂ ∂ L L / / ∂ ∂ G G = = 0 0 and ∂ ∂ L L / / ∂ ∂ a a n n = = 0 0 simultaneously. Because L L is a function of the function <span class="italic">G</span> (i.e., L L is a functional), we use the Euler‐Lagrange equation to solve ∂ ∂ L L / / ∂ ∂ G G = = 0 0 . First, we substitute Equations C2 C2 and C3 C3 into Equation C1 C1 and rewrite L L as  (C4) (C4)  L L G G , , a a 1 1 , , ⋯ ⋯ , , a a N N = = ∫ ∫ Ω Ω d d 2 2 r r s s ∫ ∫ − − ∞ ∞ 0 0 f f r r s s , , τ τ , , a a 1 1 , , ⋯ ⋯ , , a a N N d d τ τ + + ∑ ∑ n n = = 1 1 N N a a n n X X n n r r , , t t n n , , where  (C5) (C5)  f f = = G G r r , , 0 0 ∣ ∣ r r s s , , τ τ log log G G r r , , 0 0 ∣ ∣ r r s s , , τ τ G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ − − ∑ ∑ n n = = 1 1 N N a a n n G G r r , , 0 0 ∣ ∣ r r s s , , τ τ X X n n s s r r s s , , τ τ + + t t n n . . Next, we solve <span class="italic">∂f</span> / <span class="italic">∂G</span> = 0. This yields <span class="italic">G</span>  <span class="subscript">ME</span> in Equation 24 24 , where <span class="italic">G</span>  <span class="subscript">ME</span> is a function of <span class="italic">N</span> unknowns <span class="italic">a</span>  <span class="subscript">1</span> , ⋯, <span class="italic">a</span>  <span class="subscript"><span class="italic">N</span></span> . Substituting <span class="italic">G</span>  <span class="subscript">ME</span> into Equation 23 23 turns X X n n ′ ′ into a function of the <span class="italic">N</span> unknowns <span class="italic">a</span>  <span class="subscript">1</span> , ⋯, <span class="italic">a</span>  <span class="subscript"><span class="italic">N</span></span> as well. Finally, <span class="italic">a</span>  <span class="subscript">1</span> , ⋯, <span class="italic">a</span>  <span class="subscript"><span class="italic">N</span></span> are determined by using <span class="italic">N</span> constraint equations derived from setting ∂ ∂ L L / / ∂ ∂ a a n n = = 0 0 . Collecting <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> , X X n n ′ ′ and <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> into column vectors <span class="bold">x</span> , <span class="bold">x</span> ′, and <span class="bold">a</span> , respectively, the <span class="italic">N</span> constraint equations can be written as  (C6) (C6)  x x ′ ′ ( ( a a ) ) = = x x , , where <span class="bold">a</span> can be solved using standard numerical routines, for example, fsolve in MATLAB.</p><p class="p">The principle of MDI is also known as the principle of Maximum Entropy (MaxEnt) (Jaynes, 1957 1957 ), which maximizes the negative relative entropy subject to constraints. Here, we refer to the procedure of deriving Equation 24 24 as the MaxEnt method following Khatiwala et al. ( 2009 2009 ).</p></div><div class="section"><h2 class="section-title">Least Squares Solution</h2><span class="label">C3</span><p class="p">In practice, an exact fit between <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> and X X n n ′ ′ (i.e., Equation C6 C6 ) is not desirable, because there are errors in Equation 23 23 and in observations. Solving for <span class="bold">a</span> using Equation C6 C6 sometimes results in an overfitted <span class="italic">G</span>  <span class="subscript">ME</span> that is difficult to interpret physically. For instance, a <span class="italic">G</span>  <span class="subscript">ME</span> may have extremely large values at just a few <span class="bold">r</span>  <span class="subscript">s</span> and <span class="italic">τ</span> locations, as opposed to a much broader distribution in <span class="italic">G</span>  <span class="subscript">pr</span> derived from models. These extreme cases often come with large <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> values, which modify <span class="italic">G</span>  <span class="subscript">pr</span> via the exponential function in Equation 24 24 .</p><p class="p">To avoid overfitting, we relax the equality constraints and solve for <span class="bold">a</span> in a least squares sense with Tikhonov regularization (Tikhonov & Arsenin, 1977 1977 ). This gives <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> in Equation 26 26 . The regularization term λ λ ‖ ‖ a a ‖ ‖ 2 2 2 2 penalizes large <span class="italic">a</span>  <span class="subscript"><span class="italic">n</span></span> values that cause <span class="italic">G</span>  <span class="subscript">ME</span> to deviate from <span class="italic">G</span>  <span class="subscript">pr</span> substantially.</p><p class="p">We determine the <span class="italic">λ</span> value using the L‐curve method (Hansen & O’Leary, 1993 1993 ). A smaller <span class="italic">λ</span> value corresponds to a smaller model‐data misfit and a larger ‖ ‖ a a ‖ ‖ 2 2 2 2 value. Setting <span class="italic">λ</span> = 0 gives <span class="bold">a</span> without the regularization (i.e., Equation C6 C6 ). The L‐curve method finds the smallest <span class="italic">λ</span> allowed before any further decrease of <span class="italic">λ</span> leads to a rapid increase of ‖ ‖ a a ‖ ‖ 2 2 2 2 . The L‐curve method requires repeating the minimization process for different <span class="italic">λ</span> values, which is computationally prohibitive if carried out at each interior location. We choose <span class="italic">λ</span> by applying the L‐curve method to the centers of the subtropical gyres, where ocean tracers tend to accumulate. We find that the optimal <span class="italic">λ</span> value is between 0.1 and 10 in those locations; <span class="italic">λ</span> values within that range give a similar model‐data misfit and a similar ‖ ‖ a a ‖ ‖ 2 2 2 2 value. Based on this evidence, we set <span class="italic">λ</span> to unity globally in this study.</p></div></div><div class="app"><span class="label">Appendix D</span><span class="title">Simulating Tracer Observations</span><p class="p">We include CFCs, SF <span class="subscript">6</span> and bomb Δ <span class="superscript">14</span> C in the HadCM3 historical simulation. All these tracers are simulated in the ocean with zero initial conditions and prescribed surface concentration boundary conditions (BCs) from 1860 to 2008. The BCs are derived by interpolating monthly outputs of the CESM2 historical simulation to each timestep of HadCM3 linearly. CESM2 is chosen here because it is the only model available to us that includes CFCs, SF <span class="subscript">6</span> and Δ <span class="superscript">14</span> C in a historical simulation.</p><p class="p">For simplicity, we choose not to simulate the air‐sea gas transfer of chemical tracers in HadCM3, which is different from the CMIP6 biogeochemical protocol (Orr et al., 2017 2017 ). This is because the MaxEnt method is not concerned with the air‐sea gas transfer. <span class="italic">G</span>  <span class="subscript">ME</span> is determined by the relationship between X X n n s s and <span class="italic">X</span>  <span class="subscript"><span class="italic">n</span></span> , which is only affected by ocean transports (e.g., <span class="italic">L</span>  <span class="subscript">hist</span> or <span class="italic">L</span>  <span class="subscript">ctrl</span> ).</p><p class="p">The radioactive decay of <span class="superscript">14</span> C can be accounted for by adding an exponential decay term in Equation 23 23 (see Holzer et al., 2010 2010 ). Because the history of bomb Δ <span class="superscript">14</span> C is very short compared to its half‐life, we neglect its radioactive decay in this study. The method of simulating Δ <span class="superscript">14</span> C (hence the <span class="superscript">14</span> C/ <span class="superscript">12</span> C ratio) as a tracer was first proposed by Toggweiler et al. ( 1989 1989 ).</p></div><div class="app"><span class="label">Appendix E</span><span class="title">Inverse Gaussian Prior</span><p class="p">Following Waugh and Hall ( 2002 2002 ) the Inverse Gaussian (IG) distribution is given as  (E1) (E1)  I I G G ( ( τ τ , , Γ Γ , , Λ Λ ) ) = = Γ Γ 3 3 4 4 π π Λ Λ 2 2 τ τ 3 3 exp exp − − Γ Γ ( ( τ τ − − Γ Γ ) ) 2 2 4 4 Λ Λ 2 2 τ τ for for  τ τ > > 0 0 . .  <span class="italic">Γ</span> > 0, Λ > 0, and Γ <span class="superscript">3</span> /(2Λ <span class="superscript">2</span> ) are the mean, the width and the shape parameter of the IG distribution, respectively. Equation E1 E1 is the analytical form of <span class="italic">G</span>  <span class="subscript">c</span> for 1D flow with constant velocity and diffusivity; Γ <span class="superscript">2</span> /Λ <span class="superscript">2</span> is the Peclet number of the flow (Waugh & Hall, 2002 2002 ).</p><p class="p">We generate an ensemble of IG priors by fitting a scaled IG distribution to the FAMOUS prior (Equation 27 27 ) with varying Λ/Γ ratios.  (E2) (E2)  G G p p r r r r , , 0 0 ∣ ∣ r r s s , , τ τ = = b b r r , , r r s s I I G G ( ( − − τ τ , , Γ Γ , , Λ Λ ) ) A higher Λ/Γ ratio corresponds to a more diffusive flow, in which water parcels are ventilated over a wider range of timescales. The Λ/Γ ratio is zero for pure advective flow.</p><p class="p">For every <span class="bold">r</span>  <span class="subscript">s</span> and a given Λ/Γ ratio, we choose Γ such that the resulting IG prior has the same mean age as the FAMOUS prior for 0 ≥ <span class="italic">τ</span> > −1,000 years. The mean age between <span class="italic">τ</span>  <span class="subscript">1</span> and <span class="italic">τ</span>  <span class="subscript">2</span> is calculated as  (E3) (E3)  ∑ ∑ τ τ = = τ τ 1 1 τ τ 2 2 τ τ G G r r , , 0 0 ∣ ∣ r r s s , , τ τ / / ∑ ∑ τ τ = = τ τ 1 1 τ τ 2 2 G G r r , , 0 0 ∣ ∣ r r s s , , τ τ . .  <span class="italic">b</span> ( <span class="bold">r</span> , <span class="bold">r</span>  <span class="subscript">s</span> ) determines the fraction of water at <span class="bold">r</span> that is formed at <span class="bold">r</span>  <span class="subscript">s</span> over all <span class="italic">τ</span> values (i.e., the denominator of Equation E3 E3 ); we set this parameter to be the same as the one in the FAMOUS prior.</p><p class="p">We generate the IG prior for the Λ/Γ ratio of 0.5, 1.0, and 1.5 to cover its likely range in the ocean (Waugh et al., 2006 2006 ). These priors are referred to as IG‐0.5, IG‐1.0, and IG‐1.5, respectively.</p></div><div class="app"><span class="label">Appendix F</span><span class="title">Alternative Patch Designs</span><span class="p">Instead of decomposing BCs into pulses in the lon‐lat space, one could project BCs onto Empirical Orthogonal Functions (EOFs), and construct GFs based on the leading EOFs. (EOFs are the optimal coordinates to capture the spacetime variability of a field.) This method has one limitation: the sources of a tracer are often interpreted in terms of water‐mass formation sites, but EOFs do not always project back to isolated regions in the lon‐lat space.</span><span class="p">One could also reduce the patch error by prescribing a spatial pattern within every patch when simulating GFs. Such a pattern can be derived from long‐term trends for surface excess temperature or long‐term averages for surface heat fluxes, for instance. In this way, the covariance between the true GFs and BCs are better incorporated into simulated GFs than assuming that BCs are uniform within every patch. However, because tracers exhibit different patterns in their BCs, there is no universal pattern that would work for every tracer.</span></div></div></div></div>
</div>
</body>
</html>